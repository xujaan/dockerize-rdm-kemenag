var d=new Date,versionApp="?"+RDM_version,TimeZoneDiv=TzDifference-d.getTimezoneOffset(),RdmApp=angular.module("RdmApp",["ngCookies","ui.router","ui.bootstrap","oc.lazyLoad","ngSanitize","datatables","angularFileUpload","infinite-scroll","ADM-dateTimePicker","datatables.buttons"]);RdmApp.constant("ConstantAlias",{}),RdmApp.config(["$controllerProvider",function(a){}]),RdmApp.controller("HeaderController",["$scope",function(a){a.$on("$includeContentLoaded",(function(){}))}]),RdmApp.config(["$ocLazyLoadProvider",function(a){a.config({})}]),RdmApp.run(["$rootScope","$location","$state","$http","$window","$cookies",function(a,e,t,n,o,r){a.$state=t,a.userData=r.get("rdmData")||{},a.$on("$stateChangeStart",(function(){jQuery.blockUI({})})),a.$on("$viewContentLoaded",(function(){try{jQuery.unblockUI({})}catch(a){}})),a.$on("$stateChangeSuccess",(function(){jQuery.blockUI({}),setTimeout((function(){}),500);try{$scope.$apply()}catch(a){}})),t.defaultErrorHandler((function(a){window.myAppErrorLog.push(a)})),a.$on("$stateChangeError",(function(){jQuery.blockUI({}),Swal.fire({type:"error",title:"Error",showConfirmButton:!0,html:"Tidak dapat memuat halaman yang anda minta."})})),a.$on("$stateNotFound",(function(){jQuery.unblockUI({})})),a.$on("$locationChangeStart",(function(e,t,n){setTimeout((function(){$(".datepicker").hide()}),500);var o=r.get("rdmData")||"",i=r.get("_revision")||"";""==o?(console.log("Reload web"),window.location.reload()):(i!==RDM_version&&(clearCacheWB(),Swal.fire({type:"warning",title:"Update",showConfirmButton:!1,html:"Terdapat pembaharuan aplikasi, aplikasi akan dimuat ulang",timer:1500}).then((a=>{a.dismiss===Swal.DismissReason.timer&&(console.log("Reload web"),window.location.reload())}))),a.userData=JSON.parse(o),a.userData.nama=a.userData.nama.replace("+"," "))}))}]),RdmApp.controller("SidebarController",["$state","$scope",function(a,e){setTimeout((function(){handleSidebarMenuActiveLink("match",null,a)}),1e3),e.$on("$includeContentLoaded",(function(){Array.from(document.querySelectorAll(".c-sidebar")).forEach((function(a){Sidebar._sidebarInterface(a)}))}))}]),RdmApp.controller("rdmController",["$rootScope","$state","$scope","$cookies","ApiServer",function(a,e,t,n,o){a.base_url=base_url,a.selectp5ra="",a.logResize=function(){},a.arrPush=function(a){var e={};return angular.forEach(a,(function(a,t){e[t]=a})),e},a.cekLogin=function(){""==(n.get("rdmData")||"")&&(console.log("Reload web"),window.location.reload())},a.getToken=function(){return n.get("accessToken")||""},a.customepdf=function(a,e,t){a.content.splice(0,1);var n=new Date,o=n.getDate()+"-"+(n.getMonth()+1)+"-"+n.getFullYear();a.pageMargins=[20,60,20,40],a.defaultStyle.fontSize=12,a.styles.tableHeader.fontSize=14,a.header=function(){return{columns:[{alignment:"left",italics:!0,text:e,fontSize:14,margin:[10,0]},{alignment:"right",fontSize:14,text:t}],margin:20}},a.footer=function(a,e){return{columns:[{alignment:"left",text:["Created on: ",{text:o.toString()}]},{alignment:"right",text:["page ",{text:a.toString()}," of ",{text:e.toString()}]}],margin:20}};var r={hLineWidth:function(a){return.5},vLineWidth:function(a){return.5},hLineColor:function(a){return"#aaa"},vLineColor:function(a){return"#aaa"},paddingLeft:function(a){return 8},paddingRight:function(a){return 4}};return a.content[0].layout=r,a};var r=0,i=setInterval((function(){!function(){r>100?r>=107&&(clearInterval(i),$(".pre-loader").hide()):(a=r,document.getElementById("bar1").style.width=a+"%",document.getElementById("percent1").innerHTML=a+"%");var a;r++}()}),10)}]),RdmApp.controller("guruController",["$rootScope","$state","$scope","ApiServer","$location",function(a,e,t,n,o){a.dataTimeline=[],a.selectKelas="",a.posts=[],a.datasiswa=[],a.walas="",a.dataeksekutif={},a.dataextra=[],a.datakelas=[],a.profile={},a.aktif={},a.aktif.semester_id="",a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("guru/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),o.path("/dashboard"),setTimeout((function(){console.log("Reload web"),location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getprofile=function(){n.get("guru/profile",(function(e){a.profile=e.data}))},a.getprofile(),a.getdatakelas=function(){n.get("guru/getkelas",(function(n){a.datakelas=n.data,a.dataajar=n.kelas,a.walas=n.walas,a.datawalas=n.datawalas,a.extra=n.extra,a.dataextra=n.dataextra,a.p5ra=n.p5ra,console.log("KelasChange"),t.$broadcast("KelasChange",a.datakelas),t.$broadcast("KelasWalas",a.datawalas),setTimeout((function(){handleSidebarMenuActiveLink("match",null,e)}),1e3)}))},a.getdatakelas(),a.getsemester=function(){n.get("guru/datasemester",(function(e){a.datasemester=e.data}))},a.getsemester(),a.getreference=function(){n.get("guru/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference()}]),RdmApp.controller("gururaController",["$rootScope","$state","$scope","ApiServer","$location",function(a,e,t,n,o){a.dataTimeline=[],a.selectKelas="",a.posts=[],a.datasiswa=[],a.walas="",a.dataeksekutif={},a.dataextra=[],a.datakelas=[],a.profile={},a.aktif={},a.aktif.semester_id="",a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("gurura/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),o.path("/dashboard"),setTimeout((function(){console.log("Reload web"),location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getprofile=function(){n.get("gurura/profile",(function(e){a.profile=e.data}))},a.getprofile(),a.getdatakelas=function(){n.get("gurura/getkelas",(function(n){a.datakelas=n.data,a.dataajar=n.kelas,a.walas=n.walas,a.datawalas=n.datawalas,a.extra=n.extra,a.dataextra=n.dataextra,a.p5ra=n.p5ra,console.log("KelasChange"),t.$broadcast("KelasChange",a.datakelas),t.$broadcast("KelasWalas",a.datawalas),setTimeout((function(){handleSidebarMenuActiveLink("match",null,e)}),1e3)}))},a.getdatakelas(),a.getsemester=function(){n.get("gurura/datasemester",(function(e){a.datasemester=e.data}))},a.getsemester(),a.getreference=function(){n.get("gurura/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference()}]),RdmApp.controller("proktor",["$rootScope","$state","$scope","ApiServer","FileUploader","$location",function(a,e,t,n,o,r){a.datasiswa={},a.tempdatasiswa={},a.dataguru={},a.dataeksekutif={},a.datakelas={},a.MapelInduk={},a.datarombel={},a.datasemester={},a.dataekstrakurikuler={},a.loaddatasiswa=!0,a.aktif={},a.aktif.semester_id="",a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.kurikulum={},a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("proktor/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),r.path("/dashboard"),setTimeout((function(){console.log("Reload web"),window.location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getdataguru=function(){n.get("proktor/guru/data",(function(e){a.dataguru=e.data}))},a.getdataadmin=function(){n.get("proktor/admin/data",(function(e){a.dataadminrdm=e.data}))},a.dataEmisSync=!1,a.emisLembagaid="",a.checkSyncEmis=function(){n.get("proktor/checkEmis",(function(e){a.dataEmisSync=e.data,a.emisLembagaid=e.lembagaid}))},a.checkSyncEmis(),a.getreference=function(){n.get("proktor/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference(),a.rendering=!1,a.chekupdate=function(){n.get("proktor/chekupdate",(function(e){0==e.success&&Swal.fire({title:"Update RDM",text:"Tersedia update aplikasi!",type:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ya, Update sekarang!"}).then((e=>{e.value&&a.doupdate("download")}))}))},a.updatedone=function(){$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang proses update!</h2>",baseZ:9999}),n.get("login/updatedone",(function(a){$.unblockUI({}),a.success?Swal.fire({type:"success",title:"Update Berhasil",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:"Aplikasi RDM sukses di update ke versi terbaru."}).then((a=>{a.value&&(console.log("Reload web"),window.location.reload())})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal menyimpan update RDM."})}))},a.doupdate=function(e){console.log("Update Confirm"+e),"download"==e?$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang mendownload Update!</h2>",baseZ:9999}):$.blockUI({message:"<h2>Harap bersabar!!<br>Sedang proses update!</h2>",baseZ:9999}),n.get("updatenew.php?"+e,(function(t){$.unblockUI({}),console.log(t.success),t.success?"download"==e?a.doupdate("extract"):"extract"==e&&a.updatedone():void 0!==t.message?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}):"download"==e?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengunduh file update."}):"extract"==e&&Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengextract file update."})}))},a.chekupdate(),a.getdatasiswa=function(e){$.blockUI({}),n.post("proktor/siswa/data",e,(function(e){$.unblockUI({}),a.datasiswa=e.data}))},a.getdataajar=function(e){$.blockUI({}),n.post("proktor/ajar/data",e,(function(e){$.unblockUI({}),a.dataajar=e.data,a.mapelajar=e.mapel}))},a.datasiswa={},a.pimpinan={},a.getprofile=function(){n.get("proktor/profile",(function(e){a.profile=e.data,a.pimpinan=e.pimpinan}))},a.getprofile(),a.aturcetak={},a.rechaptcha={},a.mobile={},a.getdataadmin(),a.getdataguru(),a.getpengaturan=function(){n.get("proktor/pengaturan/data",(function(e){a.tahunajaran=e.tahunajaran,a.datasemester=e.semester,a.aturcetak=e.aturcetak,a.penilaian.system=e.sistem_penilaian,a.mobile=e.mobile,a.rechaptcha=e.rechaptcha}))},a.penilaian={},a.getpengaturan(),a.getsemester=function(){n.get("proktor/semester/data",(function(e){a.datasemester=e.data,a.aturcetak=e.aturcetak}))},a.gettahunajaran=function(){n.get("proktor/tahunajaran/data",(function(e){a.tahunajaran=e.data}))},a.dataKelas=[],a.getdatakelas=function(){n.get("proktor/kelas/data",(function(e){a.dataKelas=e.data,a.getdatatingkat(),t.$broadcast("KelasChange",a.datakelas)}))},a.getdatakelas(),a.getdatatingkat=function(){n.get("proktor/kelas/datatingkat",(function(e){a.tingkat=e.tingkat,a.jurusan=e.jurusan,a.kelas=e.kelas,a.kurikulum=e.kurikulum}))},a.getdataekstra=function(){a.rendering=!1,n.get("proktor/ekstrakurikuler/data",(function(e){$.unblockUI({}),a.dataekstrakurikuler=e.data,setTimeout((function(){a.rendering=!0}))}))},a.reloaddataProktor=function(){a.getdataguru(),a.getprofile(),a.getsemester(),a.gettahunajaran(),a.getdataMapel(),a.getdatakelas()};var i=t.updater=new o({url:base_url+"proktor/updatemanual"});t.hapussemua=function(){i.clearQueue()},i.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),i.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|zip|".indexOf(t)}}),i.onErrorItem=function(a,e,t,n){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Koneksi ke server gagal."})},i.onSuccessItem=function(e,n,o,r){t.$apply(),n.success?(t.datarestore=n.data,$(".update-modal").modal("hide"),a.doupdate("extract")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message})},i.onCompleteAll=function(){t.hapussemua()},i.onBeforeUploadItem=function(a){a.url=base_url+"proktor/updatemanual"},i.onAfterAddingAll=function(a){i.uploadAll()}}]),RdmApp.controller("administrasi",["$rootScope","$state","$scope","ApiServer","$location",function(a,e,t,n,o){a.datasiswa={},a.tempdatasiswa={},a.dataguru={},a.dataeksekutif={},a.datakelas={},a.MapelInduk={},a.datarombel={},a.datasemester={},a.dataekstrakurikuler={},a.kelasnum=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],a.kelasalpa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.refpendidikan={},a.refagama={},a.refstatus_anak={},a.refpekerjaan={},a.loaddatasiswa=!0,a.aktif={},a.aktif.semester_id="",a.dochangeSemester=function(){console.log(a.aktif.semester_id),$(".semester-modal").modal("hide"),Swal.fire({title:"Ubah Semester",text:"Apakah anda yakin ingin mengubah semester?",type:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Ubah!"}).then((e=>{e.value&&($.blockUI({}),n.post("administrasi/ubahsemester",{semesteraktif:a.aktif.semester_id},(function(a){$.unblockUI({}),a.success?(Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Semester berhasil diubah",timer:1e3}),o.path("/dashboard"),setTimeout((function(){console.log("Reload web"),window.location.reload()}),1e3)):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,html:a.message}).then((a=>{a.value&&($(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))})))}))},a.ubahSemesterAktif=function(){$(".semester-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}),console.log("Fire change semester")},a.getdataguru=function(){n.get("proktor/guru/data",(function(e){a.dataguru=e.data}))},a.rendering=!1,a.chekupdate=function(){n.get("administrasi/chekupdate",(function(e){0==e.success&&Swal.fire({title:"Update RDM",text:"Tersedia update aplikasi!",type:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Ya, Update sekarang!"}).then((e=>{e.value&&a.doupdate("download")}))}))},a.getdatasiswa=function(e){$.blockUI({}),n.post("proktor/siswa/data",e,(function(e){$.unblockUI({}),a.datasiswa=e.data}))},a.getajarmapel=function(e){$.blockUI({}),n.post("proktor/ajar/mapel",e,(function(e){$.unblockUI({}),a.mapelajar=e.mapel}))},a.getdataajar=function(e){$.blockUI({}),n.post("proktor/ajar/data",e,(function(e){$.unblockUI({}),a.dataajar=e.data,a.mapelajar=e.mapel}))},a.datasiswa={},a.pimpinan={},a.getreference=function(){n.get("proktor/reference",(function(e){a.refpendidikan=e.pendidikan,a.refagama=e.agama,a.refstatus_anak=e.status_anak,a.refpekerjaan=e.pekerjaan}))},a.getreference(),a.dataEmisSync=!1,a.emisLembagaid="",a.checkSyncEmis=function(){n.get("administrasi/checkEmis",(function(e){a.dataEmisSync=e.data,a.emisLembagaid=e.lembagaid}))},a.checkSyncEmis(),a.getprofile=function(){n.get("administrasi/profile",(function(e){a.profile=e.data,a.dataprofile=e.profile}))},a.getprofile(),a.aturcetak={},a.getdataguru(),a.getpengaturan=function(){n.get("proktor/pengaturan/data",(function(e){a.tahunajaran=e.tahunajaran,a.datasemester=e.semester,a.aturcetak=e.aturcetak,a.penilaian.system=e.sistem_penilaian}))},a.penilaian={},a.getpengaturan(),a.getsemester=function(){n.get("proktor/semester/data",(function(e){a.datasemester=e.data,a.aturcetak=e.aturcetak}))},a.gettahunajaran=function(){n.get("proktor/tahunajaran/data",(function(e){a.tahunajaran=e.data}))},a.dataKelas={},a.getdatakelas=function(){n.get("proktor/kelas/data",(function(e){a.dataKelas=e.data,a.getdatatingkat(),t.$broadcast("KelasChange",a.datakelas)}))},a.getdatakelas(),a.getdataMapel=function(){n.get("proktor/mapel/data",(function(e){a.dataMapel=e.data,a.MapelInduk=e.induk}))},a.getdataMapel(),a.getdatatingkat=function(){n.get("proktor/kelas/datatingkat",(function(e){a.tingkat=e.tingkat,a.jurusan=e.jurusan,a.kelas=e.kelas,a.kurikulum=e.kurikulum}))},a.getdataekstra=function(){a.rendering=!1,n.get("administrasi/ekstrakurikuler/data",(function(e){$.unblockUI({}),a.dataekstrakurikuler=e.data,setTimeout((function(){a.rendering=!0}))}))},a.reloaddataProktor=function(){a.getdataguru(),a.getprofile(),a.getsemester(),a.gettahunajaran(),a.getdataMapel(),a.getdatakelas()}}]);
angular.module("RdmApp").directive("select2",["$timeout","$parse",function(e,n){return{restrict:"A",scope:{selectWidth:"@",ngModel:"=",ngDisabled:"="},link:function(e,n,t){e.selectWidth=e.selectWidth||"100%",n.select2({width:e.selectWidth,height:33,disabled:e.ngDisabled}),e.$watch("ngModel",(function(e,t){window.setTimeout((function(){n.select2("val",e)}))}))}}}]),RdmApp.directive("ngXlinkHref",(function(){return{priority:99,restrict:"A",link:function(e,n,t){t.$observe("ngXlinkHref",(function(e){e&&t.$set("xlink:href",e)}))}}})),RdmApp.directive("onSizeChanged",["$window",function(e){return{restrict:"A",scope:{onSizeChanged:"&"},link:function(n,t,i){var o=t[0];!function(e,n){e.cachedElementWidth=n.offsetWidth,e.cachedElementHeight=n.offsetHeight}(n,o),e.addEventListener("resize",(function(){if(n.cachedElementWidth!=o.offsetWidth||n.cachedElementHeight!=o.offsetHeight){n.onSizeChanged()()}}))}}}]),RdmApp.directive("ngBindHtmlUnsafe",[function(){return function(e,n,t){n.addClass("ng-binding").data("$binding",t.ngBindHtmlUnsafe),e.$watch(t.ngBindHtmlUnsafe,(function(e){"0"==e?n.html("0"):n.html(e||"")}))}}]),RdmApp.directive("bDatepicker",(function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",minDate:"=",maxDate:"="},link:function(e,n,t,i){var o={format:"yyyy-mm-dd",autoclose:!0,onSelect:function(n){!function(n){console.log(n),""!==n&&e.$apply((function(){i.$setViewValue(n)}))}(n),this.focus()},onClose:function(e){this.blur()}};e.$watch("maxDate",(function(e,t){$(n).datepicker("option","endDate",e)})),e.$watch("minDate",(function(e,t){$(n).datepicker("option","startDate",e),$(n).datepicker("option","defaultDate",e)})),e.$watch("ngModel",(function(e){n.datepicker("setDate",new Date(e))})),n.datepicker(o)}}})),RdmApp.directive("timeAgo",["timeAgo","nowTime",function(e,n){return{restrict:"EA",link:function(t,i,o){var r;o.$observe("fromTime",(function(n){r=e.parse(n)})),t.$watch((function(){return n()-r}),(function(n){$(i).text(e.inWords(n))}))}}}]),RdmApp.directive("whenScrolled",(function(){return{restrict:"A",link:function(e,n,t){raw=n[0],console.log(n),n.bind("scroll",(function(){console.log("scroll"),raw.scrollTop+raw.offsetHeight+5>=raw.scrollHeight&&(e.loading=!0,e.$apply(t.whenScrolled))}))}}})),RdmApp.factory("httpPostFactory",["$http",function(e){return function(n,t,i){e({url:n,method:"POST",data:t,headers:{"Content-Type":void 0}}).then((function(e){console.log(e),i(e.data)}))}}]),RdmApp.directive("bnLazySrc",["$window","$document",function(e,n){var t=function(){var t=[],i=null,o=$(e),r=n,c=r.height(),l=null,a=!1;function u(){if(!i){var e=r.height();e!==c&&(c=e,d())}}function f(){console.log("Checking for visible images...");for(var e=[],n=[],i=o.height(),r=o.scrollTop(),c=r+i,l=0;l<t.length;l++){var a=t[l];a.isVisible(r,c)?e.push(a):n.push(a)}for(l=0;l<e.length;l++)e[l].render();t=n,s(),t.length||h()}function s(){clearTimeout(i),i=null}function d(){i=setTimeout(f,100)}function h(){a=!1,o.off("resize.bnLazySrc"),o.off("scroll.bnLazySrc"),clearInterval(l)}function g(){i||d()}return{addImage:function(e){t.push(e),i||d(),a||(a=!0,o.on("resize.bnLazySrc",g),o.on("scroll.bnLazySrc",g),l=setInterval(u,2e3))},removeImage:function(e){for(var n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}t.length||(s(),h())}}}();function i(e){var n=null,t=!1,i=null;function o(){""!==n&&n!==base_url&&(e[0].src=n)}return{isVisible:function(n,t){if(!e.is(":visible"))return!1;null===i&&(i=e.height());var o=e.offset().top,r=o+i;return o<=t&&o>=n||r<=t&&r>=n||o<=n&&r>=t},render:function(){t=!0,o()},setSource:function(e){n=e,t&&o()}}}return{link:function(e,n,o){var r=new i(n);t.addImage(r),o.$observe("bnLazySrc",(function(e){r.setSource(e)})),e.$on("$destroy",(function(){t.removeImage(r)}))},restrict:"A"}}]);
RdmApp.factory("ApiServer",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).done((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,a){r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).done((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).fail((function(e,n,t,r){a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("ApiPusat",["$http","$rootScope","$timeout",function(e,n,t){var r={};return r.post=function(e,r,a){n.cekLogin();var o=n.getToken();$.ajax({url:"https://rdm.hdmadrasah.id/api/"+e,method:"POST",dataType:"json",crossDomain:!0,contentType:"application/json; charset=utf-8",data:JSON.stringify(r),cache:!1,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+o)},success:function(e){t((function(){a(e)}),1e3)},error:function(e,n,t){a({success:!1,message:"Gagal menghubungi server."})}})},r}]),RdmApp.factory("common",["$http","$rootScope","$timeout",function(e,n,t){var r={get:function(e,r){n.cekLogin(),$.post(e).success((function(e,n,a){"application/json"==(a.getResponseHeader("content-type")||"")?t((function(){r(e)}),1e3):r({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,a){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),r({success:!1,message:"Gagal menghubungi server."})}))},post:function(e,r,a){n.cekLogin(),$.post(e,r).success((function(e,n,r){"application/json"==(r.getResponseHeader("content-type")||"")?t((function(){a(e)}),1e3):a({success:!1,message:"Terdapat kesalahan pada server."})})).error((function(e,n,t,r){Swal.fire({type:"error",title:"Gagal menyimpan",text:"Koneksi keserver gagal",showConfirmButton:!1,timer:1500}),a({success:!1,message:"Gagal menghubungi server."})}))}};return r}]),RdmApp.factory("nowTime",["$timeout",function(e){var n=Date.now()-6e4*TimeZoneDiv,t=function(){e((function(){n=Date.now()-6e4*TimeZoneDiv,t()}),1e4)};return t(),function(){return n}}]),RdmApp.factory("timeAgo",["$timeout",function(e){var n={settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"lalu",suffixFromNow:"dari sekarang",seconds:"baru saja",minute:"semenit",minutes:"%d menit",hour:"Sejam",hours:"%d jam",day:"sehari",days:"%d hari",month:"sebulan",months:"%d bulan",year:"setahun",years:"%d tahun",numbers:[]}},inWords:function(e){var t=n.settings.strings,r=t.prefixAgo,a=t.suffixAgo;n.settings.allowFuture&&e<0&&(r=t.prefixFromNow,a=t.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,u=i/24,c=u/365;function p(n,r){var a=$.isFunction(n)?n(r,e):n,o=t.numbers&&t.numbers[r]||r;return a.replace(/%d/i,o)}var m=o<45&&p(t.seconds,Math.round(o))||o<90&&p(t.minute,1)||s<45&&p(t.minutes,Math.round(s))||s<90&&p(t.hour,1)||i<24&&p(t.hours,Math.round(i))||i<42&&p(t.day,1)||u<30&&p(t.days,Math.round(u))||u<45&&p(t.month,1)||u<365&&p(t.months,Math.round(u/30))||c<1.5&&p(t.year,1)||p(t.years,Math.round(c)),f=void 0===t.wordSeparator?" ":t.wordSeparator;return o<45?$.trim([r,m,""].join(f)):$.trim([r,m,a].join(f))},parse:function(e){if(angular.isNumber(e))return parseInt(e,10);var n=$.trim(e);return n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)}};return n}]);
angular.module("RdmApp").filter("html",["$sce",function(t){return t.trustAsHtml}]);
angular.module("RdmApp").config(["$stateProvider","$urlRouterProvider",function(a,e){e.otherwise("/dashboard"),a.state("dashboard",{url:"/dashboard",templateUrl:"default.html",data:{pageTitle:"Beranda RDM",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"DashboardCtrl",sidebar:!1}).state("datakelas",{url:"/datakelas",templateUrl:"guru/pages/datakelas"+versionApp,data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"datakelasCtrl",sidebar:!1}).state("ekstra",{url:"/ekstra/:idextra",templateUrl:"ekstra.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"ekstraCtrl",sidebar:!1}).state("p5ra",{url:"/p5ra/:idp5",templateUrl:"p5ra.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"p5raCtrl",sidebar:!1}).state("target",{url:"/target/:idproyek",templateUrl:"target.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"targetCtrl",sidebar:!1}).state("walas",{url:"/walas",templateUrl:"walas.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"walasCtrl",sidebar:!1}).state("walas.siswa",{url:"/siswa",templateUrl:"walas_siswa.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"siswaCtrl",sidebar:!1}).state("walas.rapor",{url:"/rapor",templateUrl:"walas_rapor.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"raporCtrl",sidebar:!1}).state("walas.raporp5",{url:"/raporp5",templateUrl:"walas_raporp5.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"raporp5Ctrl",sidebar:!1}).state("walas.absen",{url:"/absen",templateUrl:"walas_absen.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"absenCtrl",sidebar:!1}).state("walas.catatan",{url:"/catatan",templateUrl:"walas_catatan.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"catatanCtrl",sidebar:!1}).state("walas.nilai",{url:"/nilai",templateUrl:"walas_nilai.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"nilaiCtrl",sidebar:!1}).state("walas.prestasi",{url:"/prestasi",templateUrl:"walas_prestasi.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"prestasiCtrl",sidebar:!1}).state("walas.sikapsos",{url:"/sikapsos",templateUrl:"walas_sikapsos.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"sikapsosCtrl"}).state("walas.sikapspiritual",{url:"/sikapspiritual",templateUrl:"walas_sikapspiritual.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"sikapspiritualCtrl"}).state("kelas",{url:"/kelas/:idkelas",templateUrl:"kelas.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"kelasCtrl",sidebar:!0}).state("kelas.beranda",{url:"/beranda",templateUrl:"kelas_beranda.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"berandaCtrl",sidebar:!0}).state("kelas.nagama",{url:"/nagama",templateUrl:"kelas_nagama.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"nagamaCtrl",sidebar:!0}).state("kelas.lagama",{url:"/lagama",templateUrl:"kelas_lagama.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"lagamaCtrl",sidebar:!0}).state("kelas.agama",{url:"/agama",templateUrl:"kelas_agama.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"agamaCtrl",sidebar:!0}).state("kelas.jatidiri",{url:"/jatidiri",templateUrl:"kelas_jatidiri.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"jatidiriCtrl",sidebar:!0}).state("kelas.jatidirin",{url:"/jatidirin",templateUrl:"kelas_jatidirin.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"jatidirinCtrl",sidebar:!0}).state("kelas.jatidiril",{url:"/jatidiril",templateUrl:"kelas_jatidiril.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"jatidirilCtrl",sidebar:!0}).state("kelas.dasar",{url:"/dasar",templateUrl:"kelas_dasar.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"dasarCtrl",sidebar:!0}).state("kelas.dasarn",{url:"/dasarn",templateUrl:"kelas_dasarn.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"dasarnCtrl",sidebar:!0}).state("kelas.dasarl",{url:"/dasarl",templateUrl:"kelas_dasarl.html",data:{pageTitle:"Kelas Siswa",pageThumb:"Home",pageSubThumb:{0:"Login"}},controller:"dasarlCtrl",sidebar:!0})}]);
angular.module("RdmApp").controller("DashboardCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,o,a,i,r,n,l){t.editProfile=function(){$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.getdashboard=function(){l.get("gurura/dashboard",(function(t){e.dashboard=t.data}))},t.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),l.post("gurura/saveprofile",e.profile,(function(t){$.unblockUI({}),t.success?(e.getprofile(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".edit-modal").modal("show")}))}))},t.getdashboard(),t.browseimage=function(){$("#imageFile").click()},t.$on("pictureInsert",(function(t,o){e.profile.guru_foto=o}))}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(t){return{restrict:"A",scope:!0,link:function(e,o,a){o.bind("change",(function(){$.blockUI({});var a=new FormData;a.append("file",o[0].files[0]);var i=o[0].getAttribute("data-url");o[0].getAttribute("image-container");t(i,a,(function(t){$.unblockUI({}),t&&t.success?e.$emit("pictureInsert",t.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.data})}))}))}}}]);
angular.module("RdmApp").controller("absenCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,n,t,s,l,o,e){a.dtInstance={},i.knilai={},i.sakitAll={},i.ijinAll={},i.aplaAll={},a.setsakitAll=function(a){null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.sakit=a}))},a.setijinAll=function(a){console.log(a),null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.ijin=a}))},a.setalpaAll=function(a){null!==a&&angular.forEach(i.walassiswa,(function(i){i.absen.alpa=a}))},a.tambahpas=function(){i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.simpanAbsen=function(){i.knilai={},i.knilai.absen=[],angular.forEach(i.walassiswa,(function(a){var n={};n.siswa_id=a.siswa_id,n.sakit=a.absen.sakit,n.ijin=a.absen.ijin,n.alpa=a.absen.alpa,i.knilai.absen.push(n)})),$(".edit-modal").modal("hide"),$.blockUI({}),e.post("gurura/walas/saveabsen/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".edit-modal").modal("show")}))}))},a.dtOptions=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("agamaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(i,t,e,a,n,r,l,o,s,p){t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.datanabp,(function(e){var a={};a.siswa_id=e.siswa_id,a.rapor=e.rapor,parseInt(e.rapor)&&(i=!0),a.desc=e.desc,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=a,$i++})),i?($.blockUI({}),o.post("gurura/nilai/kirimnabp",t.knilai,(function(i){$.unblockUI({}),t.getElemenNABP(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),o.post("gurura/nilai/batalnabp",t.knilai,(function(i){$.unblockUI({}),t.getElemenNABP(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!1).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("autoWidth",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("berandaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,t,e,i,l,n,s,o){void 0!==t.datakelas[t.selectKelas]?void 0!==t.datakelas[t.selectKelas].bahanajar?t.bahanajar=t.datakelas[t.selectKelas].bahanajar:t.datakelas[t.selectKelas].timeline=[]:(t.posts=[],t.datakelas[t.selectKelas]=[],t.datakelas[t.selectKelas].bahanajar=[]),a.dtInstance={},a.currPg=0,a.recordsDisplay=0,a.tambahsiswapilihan=function(){$(".tambah-modal").modal("show")},a.chselectAll=function(t){angular.forEach(a.datapilihan,(function(a){a.select=t}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{console.log(e),e.value&&($.blockUI({}),o.post("gurura/kelas/deletepilihan/"+t.selectKelas,{siswa_id:a},(function(a){$.unblockUI({}),a.success?(t.getharian(),t.getketerampilan(),t.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.knilai={},a.savedatapilihan=function(){$(".tambah-modal").modal("hide"),t.knilai.kirimnilai=[],$i=0,t.knilai.selectKelas=t.selectKelas,angular.forEach(t.datapilihan,(function(a){if("0"!==a.select){var e={};e.siswa_id=a.siswa_id,t.knilai.kirimnilai[$i]=e,$i++}})),$.blockUI({}),o.post("gurura/kelas/savepilihan",t.knilai,(function(a){$.unblockUI({}),null!==a&&a.success?(t.getharian(),t.getketerampilan(),t.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))},a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("AutoWidth",!0).withOption("responsive",!0).withOption("columnDefs",[{width:"2%",targets:0},{width:"10%",targets:-2},{width:"16%",targets:-1},{responsivePriority:1,targets:2},{responsivePriority:2,targets:-1}]).withOption("drawCallback",(function(t){if(t.aoData.length>0){var e=this.api().page.info();a.currPg=e.page,a.recordsDisplay=e.recordsDisplay,console.log(a.currPg)}$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("bobotCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,a,e,i,s,o,l,n){void 0!==a.datakelas[a.selectKelas]?void 0!==a.datakelas[a.selectKelas].bahanajar?a.bahanajar=a.datakelas[a.selectKelas].bahanajar:a.datakelas[a.selectKelas].timeline=[]:(a.posts=[],a.datakelas[a.selectKelas]=[],a.datakelas[a.selectKelas].bahanajar=[]),t.dtInstance={},t.currPg=0,t.recordsDisplay=0,t.savedataBobot=function(){$.blockUI({}),n.post("guru/kelas/savebobot/"+a.selectKelas,a.bobot,(function(t){$.unblockUI({}),null!==t&&t.success?(a.getbobotkelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},t.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){a.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withOption("AutoWidth",!0).withOption("responsive",!0).withOption("columnDefs",[{width:"2%",targets:0},{width:"10%",targets:-2},{width:"16%",targets:-1},{responsivePriority:1,targets:2},{responsivePriority:2,targets:-1}]).withOption("drawCallback",(function(a){if(a.aoData.length>0){var e=this.api().page.info();t.currPg=e.page,t.recordsDisplay=e.recordsDisplay}$(".lazy").Lazy();try{t.$apply()}catch(t){}})).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("catatanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(i,a,t,n,o,s,e,l,r){a.knilai={},i.tambahpas=function(){a.knilai.edit=!1,$(".edit-modal").modal("show")},i.simpanCatatan=function(){a.knilai={},a.knilai.absen=[],angular.forEach(a.walassiswa,(function(i){var t={};t.siswa_id=i.siswa_id,t.catatan=i.absen.catatan,a.knilai.absen.push(t)})),$(".edit-modal").modal("hide"),$.blockUI({}),l.post("gurura/walas/savecatatan/"+a.walas,a.knilai,(function(i){$.unblockUI({}),i.success?(a.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((i=>{i.value&&$(".edit-modal").modal("show")}))}))},i.dtOptions=n.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),i.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("dasarCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(i,t,e,a,r,s,n,l,o,p){t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.datadasar,(function(e){var a={};a.siswa_id=e.siswa_id,a.rapor=e.rapor,parseInt(e.rapor)&&(i=!0),a.desc=e.desc,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=a,$i++})),i?($.blockUI({}),l.post("gurura/nilai/kirimdasar",t.knilai,(function(i){$.unblockUI({}),t.getElemenDasar(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),l.post("gurura/nilai/bataldasar",t.knilai,(function(i){$.unblockUI({}),t.getElemenDasar(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!1).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("autoWidth",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("dasarlCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,e,n,t,l,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datasiswa,(function(i){i.paspat=a}))},a.hapusGambar=function(a){let e={};e.lampiran_id=a.lampiran_id,e.kelas_id=a.kelas_id,Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus gambar lampiran ini?"}).then((a=>{void 0!==a.value&&a.value&&($.blockUI({}),r.post("gurura/nilai/hapuslampiran",e,(function(a){$.unblockUI({}),i.getElemenDasar(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.simpanGambar=function(){console.log(a.datalampiran.siswa);let i={};i.lampiran_id=a.datalampiran.lampiran_id,i.lampiran_siswa=a.datalampiran.lampiran_siswa,i.siswa={},i.siswa=a.datalampiran.siswa,console.log(i),$(".lampiran-modal").modal("hide"),$.blockUI({}),r.post("gurura/nilai/simpangambar",i,(function(i){$.unblockUI({}),i.success?(a.getElemenDasar(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((a=>{a.value&&($(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.editGambar=function(i){a.datalampiran=i,$(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahLampiran=function(){i.knilai.edit=!1,$(".upload-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=n.newOptions().withOption("searching",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("stateSave",!0).withOption("paging",!1).withOption("tabIndex",-1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new s({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},a.uploaded=!1,p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|jpg|jpeg|png|".indexOf(e)||(Swal.fire({type:"warning",title:"Gagal",showConfirmButton:!0,html:"Maaf, untuk lampirah hanya dapat mengupload file gambar (jpg, jpeg atau png)"}),!1)}}),p.onSuccessItem=function(e,n,t,l){$.unblockUI(),n.success?(i.getElemenDasar(),$(".upload-modal").modal("hide"),Swal.fire({type:"success",title:"Upload",showConfirmButton:!1,html:"File Berhasil diupload",timer:1e3}).then((i=>{a.editGambar(n.data)}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message}),a.$apply(),console.info("onSuccessItem",e,n,t,l,a.gandaaa)},p.onCompleteAll=function(){p.clearQueue()},p.onBeforeUploadItem=function(a){$.blockUI({message:"<h4>Sedang Mengupload File</h4>"}),a.url=base_url+"gurura/nilai/lampirandasar/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("dasarnCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(a,n,i,l,e,t,o,s,r,p){n.nilainabp={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(n.datanabp,(function(i){null==n.nilainabp.tambahharian&&(n.nilainabp.tambahharian={}),n.nilainabp.tambahharian[i.siswa_id]=a}))},a.editKompnilai=function(a){n.nilainabp.edit=!0,n.nilainabp.komponennilai_id=a.komponennilai_id,n.nilainabp.komponennilai_materi=a.komponennilai_materi,n.nilainabp.komponennilai_nama=a.komponennilai_nama,n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},angular.forEach(n.datadasar,(function(i){null!==i.nilai&&void 0!==i.nilai[a.komponennilai_id]?n.nilainabp.tambahharian[i.siswa_id]=i.nilai[a.komponennilai_id]:n.nilainabp.tambahharian[i.siswa_id]="",null!==i.catatan&&void 0!==i.catatan[a.komponennilai_id]?n.nilainabp.tambahcatatan[i.siswa_id]=i.catatan[a.komponennilai_id]:n.nilainabp.tambahcatatan[i.siswa_id]="",console.log(n.nilainabp.tambahharian[i.siswa_id])})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){n.nilainabp={},n.nilainabp.edit=!1,n.nilainabp.komponennilai_materi="",n.nilainabp.komponennilai_nama="",n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){n.nilainabp={},n.nilainabp.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((i=>{i.value&&($.blockUI({}),s.post("gurura/nilai/deletenilai",a,(function(a){$.unblockUI({}),n.getElemenDasar(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savenabp=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/nilai/savedasar",n.nilainabp,(function(a){$.unblockUI({}),a.success?(n.getElemenDasar(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=l.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("autoWidth",!1).withOption("processing",!1);var d=a.uploader=new r({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,n){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,n){var i="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",i),-1!=="|xls|xlsx|".indexOf(i)}}),d.onSuccessItem=function(n,i,l,e){a.berhasilka=a.berhasilka+i.sukses,a.gandaaa=a.gandaaa+i.double1,a.gagalaa=a.gagalaa+i.gagal,a.$apply(),console.info("onSuccessItem",n,i,l,e,a.gandaaa)},d.onCompleteAll=function(){n.getElemenDasar()},d.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/harian/"+n.selectKelas},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("datakelasCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(t,e,a,i,l,o,s,d){t.dtInstance={},t.datakelasedit={},t.saveeditkelas=function(){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("gurura/kelas/save",t.datakelasedit,(function(t){$.unblockUI({}),t.success?(e.getdatakelas(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".edit-modal").modal("show")}))}))},t.editkelas=function(e,a,i,l,o,s){t.datakelasedit.kelas_id=e,t.datakelasedit.kelas_nama=a,t.datakelasedit.tingkat_id=i,t.datakelasedit.jurusan_id=l,t.datakelasedit.guru_id=o,t.datakelasedit.edit=s;try{t.$apply()}catch(t){}$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!0).withOption("processing",!0).withPaginationType("full_numbers")}]);
angular.module("RdmApp").controller("ekstraCtrl",["$cookies","$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$stateParams",function(a,t,e,i,l,n,s,r,o,u,c){t.selectData={},t.selectAll="0",t.selectData.kelas_id="",e.selectExtra=c.idextra,a.put("selectExtra",e.selectExtra),void 0!==e.dataextra[e.selectExtra]&&(e.dataextraguru=e.dataextra[e.selectExtra]),t.$on("KelasChange",(function(a,t){console.log("KelasChange"),void 0!==e.dataextra[e.selectExtra]&&(e.dataextraguru=e.dataextra[e.selectExtra])})),e.datasiswaextra={},t.tingkatChange=function(){t.datasiswaextra={},t.siswaextra={},t.selectData.kelas_id=""},t.chselectAll=function(a){angular.forEach(t.siswaextra,(function(t){t.select=a}))},t.tambahpas=function(){e.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},e.getdatatingkat=function(){o.get("gurura/extra/datatingkat",(function(a){e.tingkat=a.tingkat,e.jurusan=a.jurusan,e.kelas=a.kelas}))},e.getdatatingkat(),t.datasiswaextra=[],t.tambahsiswapilihan=function(){$(".tambah-modal").modal("show")},t.savedatapilihan=function(){$(".tambah-modal").modal("hide"),e.knilai={},e.knilai.kirimnilai=[],$i=0,e.knilai.extra=e.selectExtra,e.knilai.kelas_id=t.selectData.kelas_id,angular.forEach(t.siswaextra,(function(a){if("0"!==a.select){var t={};t.siswa_id=a.siswa_id,e.knilai.kirimnilai[$i]=t,$i++}})),$.blockUI({}),o.post("gurura/extra/savepilihan",e.knilai,(function(a){$.unblockUI({}),null!==a&&a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))},t.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus siswa ini dari binaan anda?"}).then((i=>{i.value&&($.blockUI({}),o.post("gurura/extra/deletepilihan",{siswa_id:a,ekstrakurikuler_id:e.selectExtra,kelas_id:t.selectData.kelas_id},(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.setnilaiextraAll=function(a){angular.forEach(t.datasiswaextra,(function(t){t.nilaiextra=a}))},t.simpanExtra=function(){e.knilai={},e.knilai.extra=[],angular.forEach(t.datasiswaextra,(function(a){var i={};i.siswa_id=a.siswa_id,i.kelas_id=t.selectData.kelas_id,i.nilaiextra=a.nilaiextra,e.knilai.extra.push(i)})),$(".edit-modal").modal("hide"),$.blockUI({}),o.post("gurura/extra/simpanextra/"+e.selectExtra,e.knilai,(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".edit-modal").modal("show")}))}))},t.selectExtranilailock=0,t.siswaextra={},t.reloadTable=function(){""!==e.selectExtra&&($.blockUI({}),t.datasiswaextra={},t.selectData.ekstrakurikuler_id=e.selectExtra,o.post("gurura/extra/datasiswa",t.selectData,(function(a){$.unblockUI({}),t.datasiswaextra=a.data,t.siswaextra=a.siswa,t.selectExtranilailock=a.nilailock})))},t.dtOptions=l.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),t.dtOptions2=l.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),t.UploadTemplate=function(){""==t.selectData.kelas_id?Swal.fire({type:"warning",title:"Kelas Kosong",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1500}):(e.knilai={},e.knilai.edit=!1,$(".upload-modal").modal("show"))};var d=t.uploader=new u({url:base_url+"gurura/extra/importnilai"});t.berhasilaa=0,t.gandaaa=0,t.gagalaa=0,t.hapussemua=function(){d.clearQueue(),t.berhasilaa=0,t.gandaaa=0,t.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),d.onSuccessItem=function(a,e,i,l){t.berhasilka=t.berhasilka+e.sukses,t.gandaaa=t.gandaaa+e.double1,t.gagalaa=t.gagalaa+e.gagal,t.$apply(),console.info("onSuccessItem",a,e,i,l,t.gandaaa)},d.onCompleteAll=function(){t.reloadTable()},d.onBeforeUploadItem=function(a){a.url=base_url+"gurura/extra/importnilai/"+e.selectExtra+"/"+t.selectData.kelas_id},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("forumCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","nowTime",function(t,e,o,n,s,i,u,r,a){t.nowTime=a,t.row=0,t.rowperpage=3,t.newPost={},t.newKomen={},t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,t.busy=!1,t.loading=!1,t.setType=function(e){t.newPost.type=e},t.saveComent=function(e,o){$.blockUI({}),t.newKomen={},t.newKomen.forumrespon_komentar=o,t.newKomen.forum_id=e.forum_id,r.post("guru/forum/savekomen",t.newKomen,(function(o){$.unblockUI({}),o.success?(t.updatePosts(e),t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:o.message})}))},t.browseimage=function(){$("#imageFile").click()},t.removeImage=function(){t.newPost.image=""},t.sendPost=function(){$.blockUI({}),r.post("guru/forum/save",t.newPost,(function(e){$.unblockUI({}),e.success?(t.getnewPosts(),t.newPost.image="",t.newPost.link="",t.newPost.text="",t.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})}))},t.getnewPosts=function(){t.posts.length>0&&(forum_id=e.posts[0].forum_id),r.get("guru/forum/newdata/"+forum_id,(function(o){o.success&&(t.row+=t.rowperpage,t.$apply((function(){angular.forEach(o.data,(function(t){e.posts.unshift(t)})),setTimeout((function(){$(".lazy").Lazy()}),1e3)})))}))},t.updatePosts=function(t){$.blockUI({}),forum_id=t.forum_id,r.get("guru/forum/getupdatedata/"+forum_id,(function(o){if($.unblockUI({}),o.success){t=o.data;const n=e.posts.findIndex((t=>t.forum_id===o.data.forum_id));e.posts[n]=o.data}}))},t.getPosts=function(){t.busy||(t.loading=!0,t.busy=!0,forum_id="0",e.posts.length>0&&(forum_id=e.posts[e.posts.length-1].forum_id),r.get("guru/forum/data/"+forum_id,(function(o){o.success?(t.row+=t.rowperpage,t.$apply((function(){angular.forEach(o.data,(function(t){e.posts.push(t)})),t.busy=!1,t.loading=!1,setTimeout((function(){$(".lazy").Lazy()}),1e3)}))):(t.busy=!1,t.loading=!1)})))},t.$on("pictureInsert",(function(e,o){t.newPost.image=o})),0==e.posts.length&&t.getPosts(),$("#postText").focus()}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(t){return{restrict:"A",scope:!0,link:function(e,o,n){o.bind("change",(function(){$.blockUI({});var n=new FormData;n.append("file",o[0].files[0]);var s=o[0].getAttribute("data-url");o[0].getAttribute("image-container");t(s,n,(function(t){$.unblockUI({}),t&&t.success?e.$emit("pictureInsert",t.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.data})}))}))}}}]);
angular.module("RdmApp").controller("harianCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(a,n,i,t,e,l,o,r,p,s){n.nilainabp={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(n.dataharian,(function(i){null==n.nilainabp.tambahharian&&(n.nilainabp.tambahharian={}),n.nilainabp.tambahharian[i.siswa_id]=a}))},a.editKompnilai=function(a){n.nilainabp.edit=!0,n.nilainabp.komponennilai_id=a.komponennilai_id,n.nilainabp.komponennilai_materi=a.komponennilai_materi,n.nilainabp.komponennilai_nama=a.komponennilai_nama,n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},angular.forEach(n.datanabp,(function(i){null!==i.nilai&&void 0!==i.nilai[a.komponennilai_id]?n.nilainabp.tambahharian[i.siswa_id]=i.nilai[a.komponennilai_id]:n.nilainabp.tambahharian[i.siswa_id]="",null!==i.catatan&&void 0!==i.catatan[a.komponennilai_id]?n.nilainabp.tambahcatatan[i.siswa_id]=i.catatan[a.komponennilai_id]:n.nilainabp.tambahcatatan[i.siswa_id]="",console.log(n.nilainabp.tambahharian[i.siswa_id])})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){n.nilainabp={},n.nilainabp.edit=!1,n.nilainabp.komponennilai_materi="",n.nilainabp.komponennilai_nama="",n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){n.nilainabp={},n.nilainabp.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(n){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((i=>{i.value&&($.blockUI({}),r.post("gurura/pengetahuan/deleteharian",n,(function(n){$.unblockUI({}),a.getharian(),n.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message})})))}))},a.savenabp=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/nilai/savenabp",n.nilainabp,(function(a){$.unblockUI({}),a.success?(n.getElemenNABP(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=t.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("autoWidth",!1).withOption("processing",!1);var h=a.uploader=new p({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){h.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},h.filters.push({name:"customFilter",fn:function(a,n){return this.queue.length<100}}),h.filters.push({name:"imageFilter",fn:function(a,n){var i="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",i),-1!=="|xls|xlsx|".indexOf(i)}}),h.onSuccessItem=function(n,i,t,e){a.berhasilka=a.berhasilka+i.sukses,a.gandaaa=a.gandaaa+i.double1,a.gagalaa=a.gagalaa+i.gagal,a.$apply(),console.info("onSuccessItem",n,i,t,e,a.gandaaa)},h.onCompleteAll=function(){n.getharian()},h.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/harian/"+n.selectKelas},h.onAfterAddingAll=function(a){h.uploadAll()}}]);
angular.module("RdmApp").controller("jatidiriCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(i,t,e,a,r,n,l,o,s,p){t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.datajd,(function(e){var a={};a.siswa_id=e.siswa_id,a.rapor=e.rapor,parseInt(e.rapor)&&(i=!0),a.desc=e.desc,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=a,$i++})),i?($.blockUI({}),o.post("gurura/nilai/kirimjd",t.knilai,(function(i){$.unblockUI({}),t.getElemenJD(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),o.post("gurura/nilai/bataljd",t.knilai,(function(i){$.unblockUI({}),t.getElemenJD(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!1).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("autoWidth",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("jatidirilCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,e,n,t,l,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datasiswa,(function(i){i.paspat=a}))},a.hapusGambar=function(a){let e={};e.lampiran_id=a.lampiran_id,e.kelas_id=a.kelas_id,Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus gambar lampiran ini?"}).then((a=>{void 0!==a.value&&a.value&&($.blockUI({}),r.post("gurura/nilai/hapuslampiran",e,(function(a){$.unblockUI({}),i.getElemenJD(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.simpanGambar=function(){console.log(a.datalampiran.siswa);let i={};i.lampiran_id=a.datalampiran.lampiran_id,i.lampiran_siswa=a.datalampiran.lampiran_siswa,i.siswa={},i.siswa=a.datalampiran.siswa,console.log(i),$(".lampiran-modal").modal("hide"),$.blockUI({}),r.post("gurura/nilai/simpangambar",i,(function(i){$.unblockUI({}),i.success?(a.getElemenJD(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((a=>{a.value&&($(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.editGambar=function(i){a.datalampiran=i,$(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahLampiran=function(){i.knilai.edit=!1,$(".upload-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=n.newOptions().withOption("searching",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("stateSave",!0).withOption("paging",!1).withOption("tabIndex",-1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new s({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},a.uploaded=!1,p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|jpg|jpeg|png|".indexOf(e)||(Swal.fire({type:"warning",title:"Gagal",showConfirmButton:!0,html:"Maaf, untuk lampirah hanya dapat mengupload file gambar (jpg, jpeg atau png)"}),!1)}}),p.onSuccessItem=function(e,n,t,l){$.unblockUI(),n.success?(i.getElemenJD(),$(".upload-modal").modal("hide"),Swal.fire({type:"success",title:"Upload",showConfirmButton:!1,html:"File Berhasil diupload",timer:1e3}).then((i=>{a.editGambar(n.data)}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message}),a.$apply(),console.info("onSuccessItem",e,n,t,l,a.gandaaa)},p.onCompleteAll=function(){p.clearQueue()},p.onBeforeUploadItem=function(a){$.blockUI({message:"<h4>Sedang Mengupload File</h4>"}),a.url=base_url+"gurura/nilai/lampiranjd/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("jatidirinCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(a,i,n,l,e,t,o,r,s,p){i.nilainabp={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datanabp,(function(n){null==i.nilainabp.tambahharian&&(i.nilainabp.tambahharian={}),i.nilainabp.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.nilainabp.edit=!0,i.nilainabp.komponennilai_id=a.komponennilai_id,i.nilainabp.komponennilai_materi=a.komponennilai_materi,i.nilainabp.komponennilai_nama=a.komponennilai_nama,i.nilainabp.tambahharian={},i.nilainabp.tambahcatatan={},angular.forEach(i.datajd,(function(n){null!==n.nilai&&void 0!==n.nilai[a.komponennilai_id]?i.nilainabp.tambahharian[n.siswa_id]=n.nilai[a.komponennilai_id]:i.nilainabp.tambahharian[n.siswa_id]="",null!==n.catatan&&void 0!==n.catatan[a.komponennilai_id]?i.nilainabp.tambahcatatan[n.siswa_id]=n.catatan[a.komponennilai_id]:i.nilainabp.tambahcatatan[n.siswa_id]="",console.log(i.nilainabp.tambahharian[n.siswa_id])})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.nilainabp={},i.nilainabp.edit=!1,i.nilainabp.komponennilai_materi="",i.nilainabp.komponennilai_nama="",i.nilainabp.tambahharian={},i.nilainabp.tambahcatatan={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.nilainabp={},i.nilainabp.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("gurura/nilai/deletenilai",a,(function(a){$.unblockUI({}),i.getElemenJD(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savenabp=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/nilai/savejd",i.nilainabp,(function(a){$.unblockUI({}),a.success?(i.getElemenJD(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=l.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("autoWidth",!1).withOption("processing",!1);var d=a.uploader=new s({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){d.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},d.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),d.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),d.onSuccessItem=function(i,n,l,e){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,l,e,a.gandaaa)},d.onCompleteAll=function(){i.getElemenJD()},d.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/harian/"+i.selectKelas},d.onAfterAddingAll=function(a){d.uploadAll()}}]);
angular.module("RdmApp").controller("kelasCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,n,i,t,d,o,e,l,r,s){i.dataharian=[],i.dataketerampilan=[],i.bobot=[],i.kkmdata=[],i.kurikulum="",i.selectKelas=t.idkelas,a.put("selectkelas",i.selectKelas),i.getbobotkelas=function(){$.blockUI({}),s.get("gurura/kelas/bobot/"+i.selectKelas,(function(a){i.kkmdata=a.data,i.bobot=a.bobot,i.kurikulum=a.kurikulum,i.getElemen()}))},i.getbobotkelas(),n.filterKelas=function(){i.datakelasSelect=[],n.filterdata=i.datakelas.filter((function(a){return a.ajar_id==i.selectKelas})),n.filterdata.length>0&&(i.datakelasSelect=n.filterdata[0]),console.log(i.datakelasSelect)},n.filterKelas(),n.$on("KelasChange",(function(a,i){console.log(i),n.filterKelas()})),n.getdatasiswa=function(){s.get("gurura/kelas/datasiswa/"+i.selectKelas,(function(a){i.datasiswa=a.data}))},n.getdatasiswa(),i.dataRapor={},i.dataRapork={},i.datakomponennabp=[],i.getElemen=function(){i.getElemenNABP(),i.getElemenJD(),i.getElemenDasar()},i.getElemenNABP=function(){$.blockUI({}),s.get("gurura/nilai/datanabp",(function(a){$.unblockUI({}),i.datanabp=[],i.datakomponennabp=a.komponen,i.datanilainabp=a.datanilai,i.datacatatannabp=a.datacatatan,i.dataRapornabp=a.datarapor,i.lampirannabp=a.lampiran,angular.forEach(i.datasiswa,(function(a){let n=i.arrPush(a);if(i.datanabp.push(n),void 0!==i.datacatatannabp[n.siswa_id]?n.catatan=i.datacatatannabp[n.siswa_id]:n.catatan=[],void 0!==i.datanilainabp[n.siswa_id]){n.nilai=i.datanilainabp[n.siswa_id];var t="";let a=0;angular.forEach(i.datakomponennabp,(function(d){var o;a++,null!=(o=void 0!==n.nilai[d.komponennilai_id]?parseInt(n.nilai[d.komponennilai_id]):null)&&(t+=0==o?"perlu bimbingan dalam ":"mampu ",""!==n.catatan[d.komponennilai_id]?t+=d.komponennilai_materi+" "+n.catatan[d.komponennilai_id]:t+=d.komponennilai_materi,a<i.datakomponennabp.length?t+=", ":t+=".")})),n.desc=t,""!==t&&(n.rapor="1")}else n.nilai=[],n.desc="";void 0!==i.dataRapornabp[n.siswa_id]&&(n.rapor=i.dataRapornabp[n.siswa_id].rapor_nilai,n.desc=i.dataRapornabp[n.siswa_id].rapor_deskripsi),console.log(n)}))}))},i.getElemenJD=function(){$.blockUI({}),s.get("gurura/nilai/datajd",(function(a){$.unblockUI({}),i.datajd=[],i.datakomponenjd=a.komponen,i.datanilaijd=a.datanilai,i.datacatatanjd=a.datacatatan,i.dataRaporjd=a.datarapor,i.lampiranjd=a.lampiran,angular.forEach(i.datasiswa,(function(a){let n=i.arrPush(a);if(i.datajd.push(n),void 0!==i.datacatatanjd[n.siswa_id]?n.catatan=i.datacatatanjd[n.siswa_id]:n.catatan=[],void 0!==i.datanilaijd[n.siswa_id]){n.nilai=i.datanilaijd[n.siswa_id];var t="";let a=0;angular.forEach(i.datakomponenjd,(function(d){var o;a++,null!=(o=void 0!==n.nilai[d.komponennilai_id]?parseInt(n.nilai[d.komponennilai_id]):null)&&(t+=0==o?"perlu bimbingan dalam ":"mampu ",""!==n.catatan[d.komponennilai_id]?t+=d.komponennilai_materi+" "+n.catatan[d.komponennilai_id]:t+=d.komponennilai_materi,a<i.datakomponenjd.length?t+=", ":t+=".")})),n.desc=t,""!==t&&(n.rapor="1")}else n.nilai=[],n.desc="";void 0!==i.dataRaporjd[n.siswa_id]&&(n.rapor=i.dataRaporjd[n.siswa_id].rapor_nilai,n.desc=i.dataRaporjd[n.siswa_id].rapor_deskripsi),console.log(n)}))}))},i.getElemenDasar=function(){$.blockUI({}),s.get("gurura/nilai/datadasar",(function(a){$.unblockUI({}),i.datadasar=[],i.datakomponendasar=a.komponen,i.datanilaidasar=a.datanilai,i.datacatatandasar=a.datacatatan,i.dataRapordasar=a.datarapor,i.lampirandasar=a.lampiran,angular.forEach(i.datasiswa,(function(a){let n=i.arrPush(a);if(i.datadasar.push(n),void 0!==i.datacatatandasar[n.siswa_id]?n.catatan=i.datacatatandasar[n.siswa_id]:n.catatan=[],void 0!==i.datanilaidasar[n.siswa_id]){n.nilai=i.datanilaidasar[n.siswa_id];var t="";let a=0;angular.forEach(i.datakomponendasar,(function(d){var o;a++,null!=(o=void 0!==n.nilai[d.komponennilai_id]?parseInt(n.nilai[d.komponennilai_id]):null)&&(t+=0==o?"perlu bimbingan dalam ":"mampu ",""!==n.catatan[d.komponennilai_id]?t+=d.komponennilai_materi+" "+n.catatan[d.komponennilai_id]:t+=d.komponennilai_materi,a<i.datakomponendasar.length?t+=", ":t+=".")})),n.desc=t,""!==t&&(n.rapor="1")}else n.nilai=[],n.desc="";void 0!==i.dataRapordasar[n.siswa_id]&&(n.rapor=i.dataRapordasar[n.siswa_id].rapor_nilai,n.desc=i.dataRapordasar[n.siswa_id].rapor_deskripsi),console.log(n)}))}))}}]);
angular.module("RdmApp").controller("keterampilanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(i,a,e,l,t,n,o,r,s,p){i.$on("$viewContentLoaded",(function(){"2"==a.kurikulum?p.go("kelas.penilaian",{idkelas:a.selectKelas}):console.log(a.kurikulum)})),a.knilai={},i.editKompnilai=function(e){a.knilai.edit=!0,a.knilai.komponennilai_id=e.komponennilai_id,a.knilai.komponennilai_materi=e.komponennilai_materi,a.knilai.komponennilai_nama=e.nama,a.knilai.uk={},a.knilai.pro={},a.knilai.por={},angular.forEach(a.dataketerampilan,(function(l){i.FilNilai=l.finalkd.filter((function(i){return i.nama==e.nama})),console.log("Finalkd:"),console.log(l.finalkd),console.log("Edit:"),console.log(e),i.FilNilai.length>0?(parseInt(i.FilNilai[0].uk)>0?a.knilai.uk[l.siswa_id]=parseInt(i.FilNilai[0].uk):a.knilai.uk[l.siswa_id]="",parseInt(i.FilNilai[0].pro)>0?a.knilai.pro[l.siswa_id]=parseInt(i.FilNilai[0].pro):a.knilai.pro[l.siswa_id]="",parseInt(i.FilNilai[0].por)>0?a.knilai.por[l.siswa_id]=parseInt(i.FilNilai[0].por):a.knilai.por[l.siswa_id]=""):(a.knilai.uk[l.siswa_id]="",a.knilai.pro[l.siswa_id]="",a.knilai.por[l.siswa_id]="")})),console.log(a.knilai),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},i.tambahharian=function(){a.knilai={},a.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},i.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/keterampilan/saveketall",a.knilai,(function(i){$.unblockUI({}),i.success?(a.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((i=>{i.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},i.kirimNilai=function(){a.knilai.kirimnilai=[],$i=0,a.knilai.selectKelas=a.selectKelas;var i=!1;angular.forEach(a.dataharian,(function(e){var l={};l.siswa_id=e.siswa_id,l.rapor=e.rapork,parseInt(e.rapork)&&(i=!0),l.predikat=e.predikatk,l.desc=e.desck,a.knilai.kirimnilai[$i]=l,$i++})),i?($.blockUI({}),r.post("gurura/keterampilan/kirimnilai",a.knilai,(function(i){$.unblockUI({}),a.getketerampilan(),a.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){a.knilai.kirimnilai=[],a.knilai.selectKelas=a.selectKelas,$.blockUI({}),r.post("gurura/keterampilan/batalnilai",a.knilai,(function(i){$.unblockUI({}),a.getketerampilan(),a.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){a.customepdf(i,"Nilai Keterampilan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!0).withOption("paging",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("lagamaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,e,n,t,l,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datasiswa,(function(i){i.paspat=a}))},a.hapusGambar=function(i){let e={};e.lampiran_id=i.lampiran_id,e.kelas_id=i.kelas_id,Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus gambar lampiran ini?"}).then((i=>{void 0!==i.value&&i.value&&($.blockUI({}),r.post("gurura/nilai/hapuslampiran",e,(function(i){$.unblockUI({}),a.getElemenNABP(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})})))}))},a.simpanGambar=function(){console.log(a.datalampiran.siswa);let i={};i.lampiran_id=a.datalampiran.lampiran_id,i.lampiran_siswa=a.datalampiran.lampiran_siswa,i.siswa={},i.siswa=a.datalampiran.siswa,console.log(i),$(".lampiran-modal").modal("hide"),$.blockUI({}),r.post("gurura/nilai/simpangambar",i,(function(i){$.unblockUI({}),i.success?(a.getElemenNABP(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message}).then((a=>{a.value&&($(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.editGambar=function(i){a.datalampiran=i,$(".lampiran-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahLampiran=function(){i.knilai.edit=!1,$(".upload-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dtOptions=n.newOptions().withOption("searching",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("stateSave",!0).withOption("paging",!1).withOption("tabIndex",-1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new s({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},a.uploaded=!1,p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|jpg|jpeg|png|".indexOf(e)||(Swal.fire({type:"warning",title:"Gagal",showConfirmButton:!0,html:"Maaf, untuk lampirah hanya dapat mengupload file gambar (jpg, jpeg atau png)"}),!1)}}),p.onSuccessItem=function(e,n,t,l){$.unblockUI(),n.success?(i.getElemenNABP(),$(".upload-modal").modal("hide"),Swal.fire({type:"success",title:"Upload",showConfirmButton:!1,html:"File Berhasil diupload",timer:1e3}).then((i=>{a.editGambar(n.data)}))):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:n.message}),a.$apply(),console.info("onSuccessItem",e,n,t,l,a.gandaaa)},p.onCompleteAll=function(){p.clearQueue()},p.onBeforeUploadItem=function(a){$.blockUI({message:"<h4>Sedang Mengupload File</h4>"}),a.url=base_url+"gurura/nilai/lampirannabp/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("nagamaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(a,n,i,l,e,t,o,p,s,r){n.nilainabp={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(n.datanabp,(function(i){null==n.nilainabp.tambahharian&&(n.nilainabp.tambahharian={}),n.nilainabp.tambahharian[i.siswa_id]=a}))},a.editKompnilai=function(a){n.nilainabp.edit=!0,n.nilainabp.komponennilai_id=a.komponennilai_id,n.nilainabp.komponennilai_materi=a.komponennilai_materi,n.nilainabp.komponennilai_nama=a.komponennilai_nama,n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},angular.forEach(n.datanabp,(function(i){null!==i.nilai&&void 0!==i.nilai[a.komponennilai_id]?n.nilainabp.tambahharian[i.siswa_id]=i.nilai[a.komponennilai_id]:n.nilainabp.tambahharian[i.siswa_id]="",null!==i.catatan&&void 0!==i.catatan[a.komponennilai_id]?n.nilainabp.tambahcatatan[i.siswa_id]=i.catatan[a.komponennilai_id]:n.nilainabp.tambahcatatan[i.siswa_id]="",console.log(n.nilainabp.tambahharian[i.siswa_id])})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){n.nilainabp={},n.nilainabp.edit=!1,n.nilainabp.komponennilai_materi="",n.nilainabp.komponennilai_nama="",n.nilainabp.tambahharian={},n.nilainabp.tambahcatatan={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){n.nilainabp={},n.nilainabp.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((i=>{i.value&&($.blockUI({}),p.post("gurura/nilai/deletenilai",a,(function(a){$.unblockUI({}),n.getElemenNABP(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savenabp=function(){$(".edit-modal").modal("hide"),$.blockUI({}),p.post("gurura/nilai/savenabp",n.nilainabp,(function(a){$.unblockUI({}),a.success?(n.getElemenNABP(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=l.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("autoWidth",!1).withOption("processing",!1);var m=a.uploader=new s({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){m.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},m.filters.push({name:"customFilter",fn:function(a,n){return this.queue.length<100}}),m.filters.push({name:"imageFilter",fn:function(a,n){var i="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",i),-1!=="|xls|xlsx|".indexOf(i)}}),m.onSuccessItem=function(n,i,l,e){a.berhasilka=a.berhasilka+i.sukses,a.gandaaa=a.gandaaa+i.double1,a.gagalaa=a.gagalaa+i.gagal,a.$apply(),console.info("onSuccessItem",n,i,l,e,a.gandaaa)},m.onCompleteAll=function(){n.getElemenNABP()},m.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/harian/"+n.selectKelas},m.onAfterAddingAll=function(a){m.uploadAll()}}]);
angular.module("RdmApp").controller("nilaiCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,n,t,l,o,s,e,c,r){i.dtInstance={},n.walasnilai={},n.dataketerampilan=[],n.bobot=[],n.kkmdata=[],i.$on("KelasChange",(function(a,i){i.length>0&&n.getwalasnilai()})),n.locknilai=function(a){""!==n.walas&&($.blockUI({}),r.post("gurura/walas/locknilai/"+n.walas,{status:a},(function(a){$.unblockUI({}),n.getwalasnilai()})))},n.getwalasnilai=function(){""!==n.walas&&($.blockUI({}),r.get("gurura/walas/datanilai/"+n.walas,(function(a){$.unblockUI({}),n.walasnilai=a.data,n.walaskirim=a.kirim,n.nilailock=a.nilailock})))},n.getwalasnilai(),i.dtOptions=o.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("nilaiketerampilanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,t,i,n,l,o,r,s){e.knilai={},a.tambahharian=function(){e.knilai={},e.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((t=>{t.value&&($.blockUI({}),r.post("gurura/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),e.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/keterampilan/nilaiket",e.knilai,(function(a){$.unblockUI({}),a.success?(e.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Absen Siswa","RDM")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){e.knilai={},e.knilai.edit=!1,$(".upload-modal").modal("show")};var u=a.uploader=new s({url:base_url+"gurura/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){u.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},u.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,e){var t="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",t),-1!=="|xls|xlsx|".indexOf(t)}}),u.onSuccessItem=function(e,t,i,n){a.berhasilka=a.berhasilka+t.sukses,a.gandaaa=a.gandaaa+t.double1,a.gagalaa=a.gagalaa+t.gagal,a.$apply(),console.info("onSuccessItem",e,t,i,n,a.gandaaa)},u.onCompleteAll=function(){e.getketerampilan()},u.onBeforeUploadItem=function(a){a.url=base_url+"gurura/keterampilan/importnilai/praktek/"+e.selectKelas},u.onAfterAddingAll=function(a){u.uploadAll()}}]);
angular.module("RdmApp").controller("p5raCtrl",["$cookies","$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$stateParams",function(a,t,e,i,o,l,n,r,s,p,c){t.selectData={},t.selectAll="0",t.selectData.pembina_id="",e.selectp5ra=c.idp5,a.put("selectP5RA",e.selectp5ra),t.$on("KelasChange",(function(a,t){console.log("KelasChange"),void 0!==e.dataextra[e.selectp5ra]&&(e.dataextraguru=e.dataextra[e.selectp5ra])})),e.datasiswaextra={},t.tingkatChange=function(){t.datasiswaextra={},t.siswaextra={},t.selectData.pembina_id=""},t.chselectAll=function(a){angular.forEach(t.siswaextra,(function(t){t.select=a}))},t.tambahpas=function(){e.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},t.dataproyek={},t.tambahproyek=function(){t.dataproyek={},t.dataproyek.pembina_id=e.selectp5ra,t.dataproyek.edit=!1,$(".tambah-modal").modal("show")},t.editproyek=function(a){t.dataproyek=a,t.dataproyek.edit=!0,$(".tambah-modal").modal("show")},t.savedataproyek=function(){$(".tambah-modal").modal("hide"),$.blockUI({}),s.post("gurura/p5ra/simpanproyek",t.dataproyek,(function(a){$.unblockUI({}),null!==a&&a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==a?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((a=>{a.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".tambah-modal").modal("show")}))}))},t.hapusproyek=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus proyek ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("gurura/p5ra/deleteproyek",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.selectproyek={},t.catatanproses=function(a){t.selectproyek=a,console.log(t.selectproyek),$.blockUI({}),s.post("gurura/p5ra/catatanproses",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.datanilai=a.data,$(".catatan-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengambil data catatan proses"})}))},t.simpancatatan=function(){console.log(t.selectproyek),e.nilai={},e.nilai.proyek_id=t.selectproyek.proyek_id,e.nilai.data=[],t.readydata=!0,angular.forEach(t.datanilai,(function(a){var t={};t.siswa_id=a.siswa_id,t.catatan_detail=a.catatan_detail,e.nilai.data.push(t)})),$(".catatan-modal").modal("hide"),$.blockUI({}),s.post("gurura/p5ra/simpancatatan",e.nilai,(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".catatan-modal").modal("show")}))}))},t.kirimproyek=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Kirim!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan pengiriman nilai ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("gurura/p5ra/kirimproyek",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.batalkirim=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Batalkan!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan pengiriman nilai ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("gurura/p5ra/batalkirim",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil dibatalkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},t.simpanExtra=function(){e.knilai={},e.knilai.extra=[],angular.forEach(t.datasiswaextra,(function(a){var i={};i.siswa_id=a.siswa_id,i.kelas_id=t.selectData.kelas_id,i.nilaiextra=a.nilaiextra,e.knilai.extra.push(i)})),$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/extra/simpanextra/"+e.selectp5ra,e.knilai,(function(a){$.unblockUI({}),a.success?(t.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&$(".edit-modal").modal("show")}))}))},t.selectp5ranilailock=0,t.tema={},t.reloadTable=function(){""!==e.selectp5ra&&($.blockUI({}),t.datasiswaextra={},t.selectData.pembina_id=e.selectp5ra,s.post("gurura/p5ra/dataproyek",t.selectData,(function(a){$.unblockUI({}),t.datasiswaextra=a.data,t.tema=a.tema})))},t.reloadTable(),t.dtOptions=o.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(a){e.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("responsive",!1).withOption("ordering",!1).withOption("processing",!1),t.dtOptions2=o.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),t.UploadTemplate=function(){""==t.selectData.kelas_id?Swal.fire({type:"warning",title:"Kelas Kosong",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1500}):(e.knilai={},e.knilai.edit=!1,$(".upload-modal").modal("show"))}}]);
angular.module("RdmApp").controller("paspatCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,e,n,t,o,l,s,r){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.datasiswa,(function(i){i.paspat=a}))},a.tambahpas=function(){i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.simpanPasPat=function(){i.knilai={},i.knilai.nilaipas={},angular.forEach(i.datasiswa,(function(a){i.knilai.nilaipas[a.siswa_id]=a.paspat})),$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/pengetahuan/savepaspat/"+i.selectKelas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getharian(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=n.newOptions().withOption("searching",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("stateSave",!0).withOption("paging",!1).withOption("tabIndex",-1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new r({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),p.onSuccessItem=function(i,e,n,t){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",i,e,n,t,a.gandaaa)},p.onCompleteAll=function(){i.getharian()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/paspat/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("pengetahuanCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$state",function(i,t,e,a,n,r,l,o,s,p){i.$on("$viewContentLoaded",(function(){"2"==t.kurikulum?p.go("kelas.penilaian",{idkelas:t.selectKelas}):console.log(t.kurikulum)})),t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.dataharian,(function(e){var a={};a.siswa_id=e.siswa_id,a.rapor=e.rapor,parseInt(e.rapor)&&(i=!0),a.predikat=e.predikat,a.desc=e.desc,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=a,$i++})),i?($.blockUI({}),o.post("gurura/pengetahuan/kirimnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),o.post("gurura/pengetahuan/batalnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Pengetahuan","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!0).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("penilaianCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(i,t,e,a,r,n,l,s,o){t.knilai={},i.kirimNilai=function(){t.knilai.kirimnilai=[],$i=0;var i=!1;angular.forEach(t.dataharian,(function(e){var a={};a.siswa_id=e.siswa_id,a.rapor=e.rapor,parseInt(e.rapor)&&(i=!0),a.predikat=e.predikat,a.desc=e.desc,a.desc_min=e.descmin,t.knilai.selectKelas=t.selectKelas,t.knilai.kirimnilai[$i]=a,$i++})),i?($.blockUI({}),s.post("gurura/pengetahuan/kirimnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))):Swal.fire({type:"warning",title:"Perhatian!!!",showConfirmButton:!0,html:"Nilai rapor masih kosong semua, nilai tidak bisa di kirim."})},i.batalNilai=function(){t.knilai.kirimnilai=[],t.knilai.selectKelas=t.selectKelas,$.blockUI({}),s.post("gurura/pengetahuan/batalnilai",t.knilai,(function(i){$.unblockUI({}),t.getharian(),t.getdatakelas(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dikirim",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})}))},i.dtOptions=a.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",titleAttr:"Print",customize:function(i){t.customepdf(i,"Nilai Rapor Kurmer","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("stateSave",!0).withOption("columnDefs",[{responsivePriority:1,targets:-3},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!1).withOption("lengthMenu",[[10,25,50,100,200,-1],[10,25,50,100,200,"All"]]).withOption("paging",!1).withOption("processing",!0)}]);
angular.module("RdmApp").controller("portofolioCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaipor&&void 0!==n.nilaipor[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaipor[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("gurura/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/keterampilan/saveforto",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("fixedColumns",{leftColumns:2}).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("tabIndex",-1).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var m=a.uploader=new s({url:base_url+"gurura/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){m.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},m.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),m.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),m.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},m.onCompleteAll=function(){i.getketerampilan()},m.onBeforeUploadItem=function(a){a.url=base_url+"gurura/keterampilan/importnilai/porto/"+i.selectKelas},m.onAfterAddingAll=function(a){m.uploadAll()}}]);
angular.module("RdmApp").controller("prestasiCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,i,e,o,s,n,d,l){a.dataEdit={},a.dodataTambah=function(){a.dataEdit={},a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.dodataEdit=function(t,i){a.dataEdit={},a.dataEdit.edit=!0,a.dataEdit.siswa_id=t,a.dataEdit.prestasi_id=i.prestasi_id,a.dataEdit.prestasi_keterangan=i.prestasi_keterangan,a.dataEdit.prestasi_nama=i.prestasi_nama,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),d.post("gurura/walas/saveprestasi/"+t.walas,a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((i=>{i.value&&($.blockUI({}),d.post("gurura/walas/deleteprestasi",a,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1)}]);
angular.module("RdmApp").controller("proyekCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaipro&&void 0!==n.nilaipro[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaipro[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("gurura/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/keterampilan/saveproyek",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("tabIndex",-1).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var p=a.uploader=new s({url:base_url+"gurura/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},p.onCompleteAll=function(){i.getketerampilan()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/keterampilan/importnilai/proyek/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("raporCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,e,s,t,l,i,o,n,r){a.dtInstance={},a.dataEdit={},a.setnaikKelas=function(a,s){console.log(a),console.log(s),$.blockUI({}),n.post("gurura/walas/naikkelas/"+e.walas,{siswa_id:a,absen_siswanaik:s},(function(a){$.unblockUI({}),a.success?(e.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&e.getwalassiswa()}))}))},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),n.post("gurura/siswa/save",a.dataEdit,(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(e){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((s=>{s.value&&($.blockUI({}),n.post("gurura/siswa/delete",{siswa_id:e},(function(e){$.unblockUI({}),e.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.message})})))}))},a.reloadTable=function(){e.datasiswa={},""!==a.selectData.kelas_id&&e.getdatasiswa(a.selectData)},a.cetakAllNilai=function(s,t){console.log(s),console.log(e.walassiswa.length),s<e.walassiswa.length?($.blockUI({message:"Proses generate nilai "+e.walassiswa[s].siswa_nama+", <br> Proses data "+Math.round(100*(s+1)/e.walassiswa.length)+"% ("+(s+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/raporra/gennilaipdf/"+e.walas+"/"+e.walassiswa[s].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllNilai(s+1,0):t>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate nilai",timer:2e3}):a.cetakAllNilai(s,t+1)}))):a.openNewAjaxTab("cetak/raporra/downnilaipdf/"+e.walas)},a.cetakAllRapor=function(s,t){console.log(s),console.log(e.walassiswa.length),s<e.walassiswa.length?($.blockUI({message:"Proses generate rapor "+e.walassiswa[s].siswa_nama+", <br> Proses data "+Math.round(100*(s+1)/e.walassiswa.length)+"% ("+(s+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/raporra/genraporpdf/"+e.walas+"/"+e.walassiswa[s].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllRapor(s+1,0):t>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate rapor",timer:2e3}):a.cetakAllRapor(s,t+1)}))):a.openNewAjaxTab("cetak/raporra/downraporpdf/"+e.walas)},a.cetakAllSampul=function(s,t){console.log(s),console.log(e.walassiswa.length),s<e.walassiswa.length?($.blockUI({message:"Proses generate sampul "+e.walassiswa[s].siswa_nama+", <br> Proses data "+Math.round(100*(s+1)/e.walassiswa.length)+"% ("+(s+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/raporra/gensampulsiswapdf/"+e.walas+"/"+e.walassiswa[s].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllSampul(s+1,0):t>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate sampul",timer:2e3}):a.cetakAllSampul(s,t+1)}))):a.openNewAjaxTab("cetak/raporra/downsampulpdf/"+e.walas)},a.cetakAllIdentitas=function(s,t){console.log(s),console.log(e.walassiswa.length),s<e.walassiswa.length?($.blockUI({message:"Proses generate identitas "+e.walassiswa[s].siswa_nama+", <br> Proses data "+Math.round(100*(s+1)/e.walassiswa.length)+"% ("+(s+1)+" dari "+e.walassiswa.length+" siswa)."}),n.get("cetak/raporra/genidentitassiswapdf/"+e.walas+"/"+e.walassiswa[s].siswa_id,(function(e){$.unblockUI({}),e.success?a.cetakAllIdentitas(s+1,0):t>2?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal generate identitas",timer:2e3}):a.cetakAllIdentitas(s,t+1)}))):a.openNewAjaxTab("cetak/raporra/downidentitaspdf/"+e.walas)},a.openNewAjaxTab=function(a){$.ajax({url:base_url+"cetak/raporra/validasi",method:"GET",headers:{"Content-type":"application/json"},responseType:"arraybuffer",success:function(e){Swal.fire({title:"Generate berhasil?",text:"Silahkan klik download!",type:"success",showCancelButton:!1,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Download!",cancelButtonText:"No"}).then((e=>{e.value&&window.open(a)}))},error:function(a){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal download",timer:2e3})}})},a.dodataEdit=function(e){a.dataEdit=e,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=t.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var w=a.uploader=new r({url:base_url+"gurura/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){w.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},w.filters.push({name:"customFilter",fn:function(a,e){return this.queue.length<100}}),w.filters.push({name:"imageFilter",fn:function(a,e){var s="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",s),-1!=="|xls|xlsx|".indexOf(s)}}),w.onSuccessItem=function(e,s,t,l){a.berhasilka=a.berhasilka+s.sukses,a.gandaaa=a.gandaaa+s.double1,a.gagalaa=a.gagalaa+s.gagal,a.$apply(),console.info("onSuccessItem",e,s,t,l,a.gandaaa)},w.onCompleteAll=function(){a.reloadTable()},w.onBeforeUploadItem=function(e){e.url=base_url+"gurura/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},w.onAfterAddingAll=function(a){w.uploadAll()}}]);
angular.module("RdmApp").controller("raporp5Ctrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,n,o,r,s,l){a.dtInstance={},a.dtInstance2={},a.dataEdit={},a.getdataproyek=function(){$.blockUI({}),s.post("gurura/p5ra/walasproyek",a.selectData,(function(t){$.unblockUI({}),a.datawalasproyek=t.data}))},a.reloadTable=function(){t.datasiswa={},""!==a.selectData.kelas_id&&t.getdatasiswa(a.selectData)},a.batalkirim=function(a){Swal.fire({type:"warning",title:"Perhatian",reverseButtons:!0,confirmButtonText:"Ya, Batalkan!",showCancelButton:!0,html:"Apakah Anda yakin akan membatalkan pengiriman nilai ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("gurura/p5ra/batalkirimwalas",{proyek_id:a.proyek_id},(function(a){$.unblockUI({}),a.success?(t.getwalasP5(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil dibatalkan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.openNewAjaxTab=function(a){$.ajax({url:base_url+"gurura/rapor/validasi",method:"GET",headers:{"Content-type":"application/json"},responseType:"arraybuffer",success:function(t){var e=a,i=document.createElement("a");i.href=e,i.target="_blank",i.download="Testing.pdf",document.body.appendChild(i),i.click(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data download",timer:2e3})},error:function(a){Swal.fire({type:"error",title:"Gagal",showConfirmButton:!1,html:"Gagal download",timer:2e3})}})},a.dodataEdit=function(t){a.dataEdit=t,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers"),a.dtOptions2=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!0).withOption("responsive",!0).withOption("processing",!0).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("drawCallback",(function(){$(".lazy").Lazy();try{a.$apply()}catch(a){}})).withPaginationType("full_numbers");var p=a.uploader=new l({url:base_url+"gurura/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),p.onSuccessItem=function(t,e,i,n){a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,n,a.gandaaa)},p.onCompleteAll=function(){a.reloadTable()},p.onBeforeUploadItem=function(t){t.url=base_url+"gurura/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("sikapCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,s,r){i.knilai={},a.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.dataharian,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilai.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("gurura/sikap/deletesikap",a,(function(a){$.unblockUI({}),i.updateSikap(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/sikap/savesikap",i.knilai,(function(a){$.unblockUI({}),a.success?(i.updateSikap(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new r({url:base_url+"gurura/sikap/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},p.onCompleteAll=function(){i.updateSikap()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/sikap/importnilai/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("sikapsosCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,l,e,t,o,s,r){i.knilai={},i.knilai.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.datasikapsos,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.sikapAll="",i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilaisos.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai.sikapAll="",i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("gurura/sikap/deletesikapwalas",a,(function(a){$.unblockUI({}),i.getSikapsos(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/sikap/savesikapwalas/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getSikapsos(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=l.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=l.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new r({url:base_url+"gurura/sikap/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,l,e){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,l,e,a.gandaaa)},p.onCompleteAll=function(){i.getSikapsos()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/sikap/importnilaiwalas/sos/"+i.walas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("sikapspiritualCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,s,r){i.knilai={},a.sikapAll="",a.setsikapAll=function(a){console.log(a),i.knilai.tambahsikap={},angular.forEach(i.datasikapspi,(function(n){null!==a&&""!==a&&(i.knilai.tambahsikap[n.siswa_id]=a)}))},a.editKompnilai=function(n){i.knilai.edit=!0,i.knilai.jenisnilai_id=n.jenisnilai_id,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.tambahsikap={},a.FilSikap=i.jenisnilaispi.filter((function(a){return a.jenisnilai_id==n.jenisnilai_id})),i.knilai.tambahsikap=a.FilSikap[0].datanilai,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),s.post("gurura/sikap/deletesikapwalas",a,(function(a){$.unblockUI({}),i.getSikapsspi(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedatasikap=function(){$(".edit-modal").modal("hide"),$.blockUI({}),s.post("gurura/sikap/savesikapwalas/"+i.walas,i.knilai,(function(a){$.unblockUI({}),a.success?(i.getSikapsspi(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("stateSave",!0).withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new r({url:base_url+"gurura/sikap/importnilaiwalas"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},p.onCompleteAll=function(){i.getSikapsspi()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/sikap/importnilaiwalas/spi/"+i.walas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("siswaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,t,e,i,l,o,s,n,d){a.dtInstance={},a.dataEdit={},a.savedataEdit=function(){$(".edit-modal").modal("hide"),$.blockUI({}),n.post("gurura/siswa/save",a.dataEdit,(function(a){$.unblockUI({}),a.success?(t.getwalassiswa(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dodataDelete=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Yes, delete it!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus data ini?"}).then((e=>{e.value&&($.blockUI({}),n.post("gurura/siswa/delete",{siswa_id:t},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},a.reloadTable=function(){t.datasiswa={},""!==a.selectData.kelas_id&&t.getdatasiswa(a.selectData)},a.dodataTambah=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))},a.dodataUpload=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1e3}):(a.dataEdit={},a.dataEdit.kelas_id=a.selectData.kelas_id,a.dataEdit.tingkat_id=a.selectData.tingkat_id,a.dataEdit.edit=!1,$(".upload-modal").modal("show"))},a.dodataEdit=function(t){a.dataEdit=t,a.dataEdit.edit=!0,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.detailUpload=[],a.selectData={},a.selectData.kelas_id="",a.selectData.tingkat_id="",a.dtOptions=i.newOptions().withOption("searching",!0).withOption("stateSave",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3,4,5]},titleAttr:"Print",customize:function(a){t.customepdf(a,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,1,2,3,4,5]},titleAttr:"Excel"}]).withOption("columnDefs",[{responsivePriority:1,targets:-1},{responsivePriority:2,targets:2},{responsivePriority:3,targets:1},{responsivePriority:4,targets:0}]).withOption("responsive",!0).withOption("paging",!0).withOption("processing",!0).withOption("drawCallback",(function(){$(".lazy").Lazy();try{setTimeout((function(){a.$apply()}),1e3)}catch(a){}})).withPaginationType("full_numbers");var r=a.uploader=new d({url:base_url+"gurura/siswa/import"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){r.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},r.filters.push({name:"customFilter",fn:function(a,t){return this.queue.length<100}}),r.filters.push({name:"imageFilter",fn:function(a,t){var e="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",e),-1!=="|xls|xlsx|".indexOf(e)}}),r.onSuccessItem=function(t,e,i,l){a.detailUpload=e.siswa,a.berhasilka=a.berhasilka+e.sukses,a.gandaaa=a.gandaaa+e.double1,a.gagalaa=a.gagalaa+e.gagal,a.$apply(),console.info("onSuccessItem",t,e,i,l,a.gandaaa)},r.onCompleteAll=function(){a.reloadTable()},r.onBeforeUploadItem=function(t){a.detailUpload=[],t.url=base_url+"gurura/siswa/import?kelas_id="+a.selectData.kelas_id+"&tingkat_id="+a.selectData.tingkat_id},r.onAfterAddingAll=function(a){r.uploadAll()}}]);
angular.module("RdmApp").controller("sumatifCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,t,l,o,r,k){i.knilai={},a.intervalkktp=[],a.intervalkktp[0]={kode:"Belum Tercapai",min:"",max:""},a.intervalkktp[1]={kode:"Cukup",min:"",max:""},a.intervalkktp[2]={kode:"Baik",min:"",max:""},a.intervalkktp[3]={kode:"Sangat Baik",min:"",max:""},a.kktpChange=function(i){if(""!=i&&i>0){var n=Math.round((100-parseInt(i))/3),e=Math.ceil((100-parseInt(i))/3),t=parseInt(i)+n,l=parseInt(t)+1*e;parseInt(i)<98?(a.intervalkktp[0]={kode:"Belum Tercapai",min:0,max:i-1},a.intervalkktp[1]={kode:"Cukup",min:i,max:t-1},a.intervalkktp[2]={kode:"Baik",min:t,max:l-1},a.intervalkktp[3]={kode:"Sangat Baik",min:l,max:100},a.updatepredikatAll()):Swal.fire({type:"warning",title:"Perhatian",showConfirmButton:!0,html:"Nilai Batas ketuntasan tidak boleh melebihi angka 97"})}},a.updatePrediket=function(n,e){console.log(n),null==n||""==n||n<a.intervalkktp[1].min?i.knilai.predikat[e]=0:n<a.intervalkktp[2].min?i.knilai.predikat[e]=1:n<a.intervalkktp[3].min?i.knilai.predikat[e]=2:n<=a.intervalkktp[3].max?i.knilai.predikat[e]=3:i.knilai.predikat[e]=0},a.updatepredikatAll=function(){angular.forEach(i.dataharian,(function(n){a.updatePrediket(i.knilai.tambahharian[n.siswa_id],n.siswa_id)}))},a.setallNilai=function(n){null!==n&&""!==n&&angular.forEach(i.dataharian,(function(e){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[e.siswa_id]=n,a.updatePrediket(n,e.siswa_id)}))},a.editKompnilai=function(n){i.knilai.edit=!0,i.knilai.komponennilai_id=n.komponennilai_id,i.knilai.komponennilai_materi=n.komponennilai_materi,i.knilai.komponennilai_nama=parseInt(n.komponennilai_nama),i.knilai.komponennilai_kktp=parseInt(n.komponennilai_kktp),i.knilai.tambahharian={},i.knilai.predikat={},a.kktpChange(i.knilai.komponennilai_kktp),angular.forEach(i.dataharian,(function(a){null!==a.nilai&&void 0!==a.nilai[n.komponennilai_id]?i.knilai.tambahharian[a.siswa_id]=parseInt(a.nilai[n.komponennilai_id]):i.knilai.tambahharian[a.siswa_id]=0})),a.updatepredikatAll(),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,i.knilai.komponennilai_materi="",i.knilai.komponennilai_nama="",i.knilai.tambahharian={},i.knilai.predikat={},$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")},a.deleteKompnilai=function(i){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("gurura/pengetahuan/deleteharian",i,(function(i){$.unblockUI({}),a.getharian(),i.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:i.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/pengetahuan/savesumatif",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getharian(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("responsive",!0).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1);var p=a.uploader=new k({url:base_url+"gurura/pengetahuan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){p.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},p.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),p.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),p.onSuccessItem=function(i,n,e,t){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,t,a.gandaaa)},p.onCompleteAll=function(){i.getharian()},p.onBeforeUploadItem=function(a){a.url=base_url+"gurura/pengetahuan/importnilai/harian/"+i.selectKelas},p.onAfterAddingAll=function(a){p.uploadAll()}}]);
angular.module("RdmApp").controller("targetCtrl",["$cookies","$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader","$stateParams",function(t,a,e,i,n,l,o,r,s,d,p){a.selectData={},a.selectAll="0",a.selectData.proyek_id="",e.selectProject=p.idproyek,t.put("selectProyek",e.selectProject),e.datasiswaextra={},a.tingkatChange=function(){a.datasiswaextra={},a.siswaextra={},a.selectData.pembina_id=""},a.chselectAll=function(t){angular.forEach(a.siswaextra,(function(a){a.select=t}))},a.tambahpas=function(){e.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.edittarget={},a.tambahtarget=function(){a.targetdata={},a.edittarget={},a.edittarget.proyek_id=e.selectProject,a.edittarget.edit=!1,$(".tambah-modal").modal("show")},a.pilihtarget=function(t){$(".tambah-modal").modal("hide"),a.edittarget.targetelemen_id=t.targetelemen_id,$.blockUI({}),s.post("gurura/p5ra/pilihtarget",a.edittarget,(function(t){$.unblockUI({}),null!==t&&t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):null==t?Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Data Gagal Disimpan"}).then((t=>{t.value&&$(".tambah-modal").modal("show")})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".tambah-modal").modal("show")}))}))},a.hapustarget=function(t){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus target dari proyek ini?"}).then((e=>{e.value&&($.blockUI({}),s.post("gurura/p5ra/hapustarget",{target_id:t.target_id},(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})})))}))},a.simpanpenilaian=function(){e.nilai={},e.nilai.target_id=a.selecttarget.target_id,e.nilai.proyek_id=a.selecttarget.proyek_id,e.nilai.data=[],a.readydata=!0,angular.forEach(a.datanilai,(function(t){var i={};i.siswa_id=t.siswa_id,i.nilai=t.nilai,null!=t.nilai&&""!=t.nilai||(a.readydata=!1),e.nilai.data.push(i)})),a.readydata?($(".penilaian-modal").modal("hide"),$.blockUI({}),s.post("gurura/p5ra/simpannilai",e.nilai,(function(t){$.unblockUI({}),t.success?(a.reloadTable(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message}).then((t=>{t.value&&$(".penilaian-modal").modal("show")}))}))):Swal.fire({type:"error",title:"Data Nilai Belum Lengkap!!!",showConfirmButton:!0,html:"Pastikan semua siswa sudah di nilai."})},a.selectProjectnilailock=0,a.dimensi={},a.selecttarget={},a.targetdata={},a.penilaian=function(t){$.blockUI({}),s.post("gurura/p5ra/penilaian",{target_id:t.target_id,proyek_id:t.proyek_id},(function(e){$.unblockUI({}),e.success?(a.selecttarget=t,a.datanilai=e.data,$(".penilaian-modal").modal("show")):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:"Gagal mengambil data penialain"})}))},a.readdatatarget=function(){$.blockUI({}),a.targetdata={},a.edittarget.proyek_id=e.selectProject,s.post("gurura/p5ra/target",a.edittarget,(function(t){$.unblockUI({}),a.targetdata=t.data}))},a.isSend=!1,a.reloadTable=function(){""!==e.selectProject&&($.blockUI({}),a.datasiswaextra={},a.selectData.proyek_id=e.selectProject,s.post("gurura/p5ra/datatarget",a.selectData,(function(t){$.unblockUI({}),a.datatarget=t.data,a.dimensi=t.dimensi,a.elemen=t.elemen,a.isSend=t.isSend})))},a.reloadTable(),a.dtOptions=n.newOptions().withOption("searching",!0).withButtons([{extend:"copy",text:'<i class="fa fa-files-o"></i> Copy',titleAttr:"Copy"},{extend:"pdfHtml5",text:'<i class="fa fa-print" aria-hidden="true"></i> Print',download:"open",exportOptions:{columns:[0,1,2,3]},titleAttr:"Print",customize:function(t){e.customepdf(t,"Absen Siswa","Rapor Digital Madrasah")}},{extend:"excelHtml5",text:'<i class="fa fa-file-text-o"></i> Excel',exportOptions:{columns:[0,2,3]},titleAttr:"Excel"}]).withOption("paging",!1).withOption("responsive",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions3=n.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){""==a.selectData.kelas_id?Swal.fire({type:"warning",title:"Kelas Kosong",showConfirmButton:!1,html:"Pilih kelas terlebih dahulu",timer:1500}):(e.knilai={},e.knilai.edit=!1,$(".upload-modal").modal("show"))}}]);
angular.module("RdmApp").controller("timelineCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","nowTime",function(e,t,a,n,i,l,s,o,u){t.dataTimeline=[],void 0!==t.datakelas[t.selectKelas]?void 0!==t.datakelas[t.selectKelas].timeline?t.dataTimeline=t.datakelas[t.selectKelas].timeline:t.datakelas[t.selectKelas].timeline=[]:(t.datakelas[t.selectKelas]=[],t.datakelas[t.selectKelas].timeline=[]),e.nowTime=u,e.row=0,e.rowperpage=3,e.newPost={},e.newKomen={},e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=3,e.busy=!1,e.loading=!1,e.setType=function(t){e.newPost.type=t},e.saveComent=function(t,a){$.blockUI({}),e.newKomen={},e.newKomen.forumrespon_komentar=a,e.newKomen.forum_id=t.forum_id,o.post("gurura/timeline/savekomen",e.newKomen,(function(a){$.unblockUI({}),a.success?(e.updatePosts(t),e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=3,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})}))},e.browseimage=function(){$("#imageFile").click()},e.removeImage=function(){e.newPost.image=""},e.sendPost=function(){$.blockUI({}),o.post("gurura/timeline/save",e.newPost,(function(t){$.unblockUI({}),t.success?(e.getnewPosts(),e.newPost.image="",e.newPost.link="",e.newPost.text="",e.newPost.type=1,Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:t.message})}))},e.getnewPosts=function(){t.dataTimeline.length>0&&(forum_id=t.dataTimeline[0].forum_id),o.get("gurura/timeline/newdata/"+forum_id,(function(a){a.success&&(e.row+=e.rowperpage,e.$apply((function(){angular.forEach(a.data,(function(e){t.dataTimeline.unshift(e)})),null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline,setTimeout((function(){$(".lazy").Lazy()}),1e3)})))}))},e.updatePosts=function(e){$.blockUI({}),forum_id=e.forum_id,o.get("gurura/timeline/getupdatedata/"+forum_id,(function(a){if($.unblockUI({}),a.success){e=a.data;const n=t.dataTimeline.findIndex((e=>e.forum_id===a.data.forum_id));t.dataTimeline[n]=a.data,null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline}}))},e.getPosts=function(){e.busy||(e.loading=!0,e.busy=!0,forum_id="0",t.dataTimeline.length>0&&(forum_id=t.dataTimeline[t.dataTimeline.length-1].forum_id),o.get("gurura/timeline/data/"+forum_id,(function(a){a.success?a.data.length>0?(e.row+=e.rowperpage,e.$apply((function(){angular.forEach(a.data,(function(e){t.dataTimeline.push(e)})),null==t.datakelas[t.selectKelas]&&(t.datakelas[t.selectKelas]=[]),null==t.datakelas[t.selectKelas].timeline&&(t.datakelas[t.selectKelas].timeline=[]),t.datakelas[t.selectKelas].timeline=t.dataTimeline,e.busy=!1,e.loading=!1,setTimeout((function(){$(".lazy").Lazy()}),1e3)}))):(e.busy=!0,e.loading=!1):(e.busy=!1,e.loading=!1)})))},e.$on("pictureInsert",(function(t,a){e.newPost.image=a})),0==t.dataTimeline.length&&e.getPosts(),$("#postText").focus()}]),angular.module("RdmApp").directive("myDirective",["httpPostFactory",function(e){return{restrict:"A",scope:!0,link:function(t,a,n){a.bind("change",(function(){$.blockUI({});var n=new FormData;n.append("file",a[0].files[0]);var i=a[0].getAttribute("data-url");a[0].getAttribute("image-container");e(i,n,(function(e){$.unblockUI({}),e&&e.success?t.$emit("pictureInsert",e.data):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:e.data})}))}))}}}]);
angular.module("RdmApp").controller("unjukkerjaCtrl",["$scope","$rootScope","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer","FileUploader",function(a,i,n,e,l,t,o,r,s){i.knilai={},a.setallNilai=function(a){null!==a&&""!==a&&angular.forEach(i.dataharian,(function(n){null==i.knilai.tambahharian&&(i.knilai.tambahharian={}),i.knilai.tambahharian[n.siswa_id]=a}))},a.editKompnilai=function(a){i.knilai.edit=!0,i.knilai.komponennilai_id=a.komponennilai_id,i.knilai.komponennilai_materi=a.komponennilai_materi,i.knilai.komponennilai_nama=a.komponennilai_nama,i.knilai.tambahharian={},angular.forEach(i.dataketerampilan,(function(n){null!==n.nilaiuk&&void 0!==n.nilaiuk[a.komponennilai_id]?i.knilai.tambahharian[n.siswa_id]=parseInt(n.nilaiuk[a.komponennilai_id]):i.knilai.tambahharian[n.siswa_id]=0})),$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.tambahharian=function(){i.knilai={},i.knilai.edit=!1,$(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"})},a.deleteKompnilai=function(a){Swal.fire({type:"warning",title:"Perhatian",confirmButtonText:"Ya, Hapus!",showCancelButton:!0,html:"Apakah Anda yakin akan menghapus nilai ini? Nilai yang sudah di hapus tidak bisa dikembalikan lagi."}).then((n=>{n.value&&($.blockUI({}),r.post("gurura/keterampilan/deletenilai",a,(function(a){$.unblockUI({}),i.getketerampilan(),a.success?Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Dihapus",timer:1e3}):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message})})))}))},a.savedataharian=function(){$(".edit-modal").modal("hide"),$.blockUI({}),r.post("gurura/keterampilan/saveunjukkerja",i.knilai,(function(a){$.unblockUI({}),a.success?(i.getketerampilan(),Swal.fire({type:"success",title:"Berhasil",showConfirmButton:!1,html:"Data Berhasil Disimpan",timer:1e3})):Swal.fire({type:"error",title:"Gagal",showConfirmButton:!0,html:a.message}).then((a=>{a.value&&($(".edit-modal").modal("show"),$(".modal-dialog").draggable({handle:".modal-header"}))}))}))},a.dtOptions=e.newOptions().withOption("searching",!0).withOption("stateSave",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.dtOptions2=e.newOptions().withOption("searching",!0).withOption("paging",!1).withOption("ordering",!1).withOption("processing",!1),a.UploadTemplate=function(){i.knilai={},i.knilai.edit=!1,$(".upload-modal").modal("show")};var u=a.uploader=new s({url:base_url+"gurura/keterampilan/importnilai"});a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0,a.hapussemua=function(){u.clearQueue(),a.berhasilaa=0,a.gandaaa=0,a.gagalaa=0},u.filters.push({name:"customFilter",fn:function(a,i){return this.queue.length<100}}),u.filters.push({name:"imageFilter",fn:function(a,i){var n="|"+a.name.substr(a.name.lastIndexOf(".")+1)+"|";return console.info("type",n),-1!=="|xls|xlsx|".indexOf(n)}}),u.onSuccessItem=function(i,n,e,l){a.berhasilka=a.berhasilka+n.sukses,a.gandaaa=a.gandaaa+n.double1,a.gagalaa=a.gagalaa+n.gagal,a.$apply(),console.info("onSuccessItem",i,n,e,l,a.gandaaa)},u.onCompleteAll=function(){i.getketerampilan()},u.onBeforeUploadItem=function(a){a.url=base_url+"gurura/keterampilan/importnilai/praktek/"+i.selectKelas},u.onAfterAddingAll=function(a){u.uploadAll()}}]);
angular.module("RdmApp").controller("walasCtrl",["$cookies","$scope","$rootScope","$stateParams","common","DTOptionsBuilder","DTColumnBuilder","$http","$q","ApiServer",function(a,i,o,n,t,e,r,s,p,k){o.dataharian=[],o.dataketerampilan=[],o.bobot=[],o.kkmdata=[],i.$on("KelasWalas",(function(a,i){console.log(Object.keys(i).length),Object.keys(i).length>0&&o.getwalassiswa()})),o.getwalassiswa=function(){""!==o.walas?($.blockUI({}),k.get("gurura/walas/datasiswa/"+o.walas,(function(a){$.unblockUI({}),o.getSikapsos(),o.getSikapsspi(),o.getwalasP5(),o.tingkatwalas=a.tingkat,o.walassiswa=a.data,o.dataabsen=a.dataabsen,o.dataprestasi=a.dataprestasi,angular.forEach(o.walassiswa,(function(a){void 0!==o.dataabsen[a.siswa_id]?a.absen=o.dataabsen[a.siswa_id]:a.absen={},void 0!==o.dataprestasi[a.siswa_id]?a.prestasi=o.dataprestasi[a.siswa_id]:a.prestasi={}}))}))):console.log("Walas kosong")},o.getwalassiswa(),o.dataRapor={},o.getharian=function(){k.get("gurura/pengetahuan/harian",(function(a){o.dataharian=[],o.datakomponen=a.komponen,o.datanilai=a.datanilai,o.datapas=a.datapas,o.dataRapor=a.datarapor,console.clear(),angular.forEach(o.datasiswa,(function(a){var n=0,t="",e="",r=100;if(void 0!==o.datanilai[a.siswa_id]){a.nilai=o.datanilai[a.siswa_id],void 0!==o.datapas[a.siswa_id]?a.paspat=parseInt(o.datapas[a.siswa_id]):(a.paspat=0,o.bobot.bobotkelas.paspat>0&&(r=0));var s=0;angular.forEach(o.datakomponen,(function(i){var o;(o=void 0!==a.nilai[i.komponennilai_id]?parseInt(a.nilai[i.komponennilai_id]):0)>n&&(n=o,t=i.komponennilai_materi),o<r&&(r=o,e=i.komponennilai_materi),s+=o})),a.nilaiharian=Math.round(s/o.datakomponen.length,0)}else a.nilai=null,a.nilaiharian=0,a.paspat=0,o.bobot.bobotkelas.harian>0&&(r=0),o.bobot.bobotkelas.paspat>0&&(r=0);if(void 0!==o.dataRapor[a.siswa_id])a.rapor=o.dataRapor[a.siswa_id].rapor_nilai,a.predikat=o.dataRapor[a.siswa_id].rapor_predikat,a.desc=o.dataRapor[a.siswa_id].rapor_deskripsi;else if(a.nilaiharian+a.paspat>0?a.rapor=Math.round((a.nilaiharian*o.bobot.bobotkelas.harian+a.paspat*o.bobot.bobotkelas.paspat)/(o.bobot.bobotkelas.harian+o.bobot.bobotkelas.paspat),2):a.rapor=0,i.FilPredikat=o.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapor&&parseInt(i.kkmgrade_max)>=a.rapor})),i.FilPredikat.length>0){a.predikat=i.FilPredikat[0].kkmgrade_kode;var p=parseInt(o.kkmdata.kkmtingkat_nilai),k="";k="A"==a.predikat?"sangat baik":"B"==a.predikat?"baik":"C"==a.predikat?"cukup baik":"kurang baik",a.desc=p<=r&&p<=n?"Memiliki kompetensi dari semua materi yang "+k+" terutama menguasai "+t:p>r&&r>0&&p<=n?"Memiliki kompetensi dari semua materi yang "+k+" terutama menguasai "+t+", dan perlu ditingkatkan dalam "+e:"Perlu pebaikan kompetensi pada seluruh materi",0==a.rapor&&(a.desc="")}else a.predikat="-",a.desc="";o.dataharian.push(a)}))}))},o.getketerampilan=function(){k.get("gurura/keterampilan/dataketerampilan",(function(a){o.dataketerampilan=[],o.komponenuk=a.komponenuk,o.datauk=a.datauk,o.komponenpro=a.komponenpro,o.datapro=a.datapro,o.komponenpor=a.komponenpor,o.datapor=a.datapor,angular.forEach(o.datasiswa,(function(a){var n=0,t="",e="",r=100;if(void 0!==o.datauk[a.siswa_id]){a.nilaiuk=o.datauk[a.siswa_id];var s=0;angular.forEach(o.komponenuk,(function(i){var p;p=void 0!==a.nilaiuk[i.komponennilai_id]?parseInt(a.nilaiuk[i.komponennilai_id]):0,o.bobot.bobotkelas.praktek>0&&(p>n&&(n=p,t=i.komponennilai_materi),p<r&&(r=p,e=i.komponennilai_materi)),s+=p})),a.uk=Math.round(s/o.komponenuk.length,0)}else a.nilaiuk=null,a.uk=0,o.bobot.bobotkelas.praktek>0&&(r=0);if(void 0!==o.datapro[a.siswa_id]){a.nilaipro=o.datapro[a.siswa_id];var p=0;angular.forEach(o.komponenpro,(function(i){var s;s=void 0!==a.nilaipro[i.komponennilai_id]?parseInt(a.nilaipro[i.komponennilai_id]):0,o.bobot.bobotkelas.proyek>0&&(s>n&&(n=s,t=i.komponennilai_materi),s<r&&(r=s,e=i.komponennilai_materi)),p+=s})),a.pro=Math.round(p/o.komponenpro.length,0)}else a.nilaipro=null,a.pro=0,o.bobot.bobotkelas.proyek>0&&(r=0);if(void 0!==o.datapor[a.siswa_id]){a.nilaipor=o.datapor[a.siswa_id];var k=0;angular.forEach(o.komponenpor,(function(i){var s;s=void 0!==a.nilaipor[i.komponennilai_id]?parseInt(a.nilaipor[i.komponennilai_id]):0,o.bobot.bobotkelas.porto>0&&(s>n&&(n=s,t=i.komponennilai_materi),s<r&&(r=s,e=i.komponennilai_materi)),k+=s})),a.por=Math.round(k/o.komponenpor.length,0)}else a.nilaipor=null,a.por=0,o.bobot.bobotkelas.porto>0&&(r=0);if(a.uk+a.pro+a.por>0?a.rapork=Math.round((a.uk*o.bobot.bobotkelas.praktek+a.pro*o.bobot.bobotkelas.proyek+a.por*o.bobot.bobotkelas.porto)/(o.bobot.bobotkelas.praktek+o.bobot.bobotkelas.proyek+o.bobot.bobotkelas.porto),2):a.rapork=0,i.FilPredikat=o.kkmdata.kkmgrade.filter((function(i){return parseInt(i.kkmgrade_min)<=a.rapork&&parseInt(i.kkmgrade_max)>=a.rapork})),i.FilPredikat.length>0){a.predikatk=i.FilPredikat[0].kkmgrade_kode;var l=parseInt(o.kkmdata.kkmtingkat_nilai),d="";d="A"==a.predikatk?"sangat baik":"B"==a.predikatk?"baik":"C"==a.predikatk?"cukup baik":"kurang baik",a.desck=l<=r&&l<=n?"Memiliki kompetensi dari semua materi yang "+d+" terutama menguasai "+t:l>r&&r>0&&l<=n?"Memiliki kompetensi dari semua materi yang "+d+" terutama menguasai "+t+", dan perlu ditingkatkan dalam "+e:"Perlu pebaikan kompetensi pada seluruh materi",0==a.rapork&&(a.desck="")}else a.predikatk="-";o.dataketerampilan.push(a)}))}))},o.getwalasP5=function(){$.blockUI({}),k.get("gurura/p5ra/walasp5/"+o.walas,(function(a){$.unblockUI({}),o.datawalasp5=a.data}))},o.getSikapsos=function(){$.blockUI({}),k.get("gurura/sikap/datasikapsos/"+o.walas,(function(a){$.unblockUI({}),o.datasikapsos=[],o.datakomponensikapsos=a.komponen,o.datanilaisikapsos=a.datanilai,o.jenisnilaisos=a.jenisnilai,angular.forEach(o.walassiswa,(function(a){o.datasikapsos.push(a)})),o.jnilaisos=0,angular.forEach(o.jenisnilaisos,(function(a){a.cnilai>0&&o.jnilaisos++}))}))},o.getSikapsspi=function(){$.blockUI({}),k.get("gurura/sikap/datasikapspi/"+o.walas,(function(a){$.unblockUI({}),o.datasikapspi=[],o.datakomponensikapspi=a.komponen,o.datanilaisikapspi=a.datanilai,o.jenisnilaispi=a.jenisnilai,angular.forEach(o.walassiswa,(function(a){o.datasikapspi.push(a)})),o.jnilaispi=0,angular.forEach(o.jenisnilaispi,(function(a){a.cnilai>0&&o.jnilaispi++}))}))}}]);
